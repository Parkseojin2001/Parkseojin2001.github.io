---
title: "νμ΄ν† μΉ κΈ°μ΄(2)"
excerpt: "λ°μ΄ν„° μ„ΈνΈμ™€ λ°μ΄ν„° λ΅λ” / λ¨λΈ & λ°μ΄ν„°μ„ΈνΈ λ¶„λ¦¬ / λ¨λΈ μ €μ¥ λ° λ¶λ¬μ¤κΈ°"

categories:
  - Pytorch
tags:
  - [Pytorch]

permalink: /pytorch/basic-2/

toc: true
toc_sticky: true

date: 2025-04-30
last_modified_at: 2025-04-30
---

## π¦¥ λ°μ΄ν„°μ„ΈνΈμ™€ λ°μ΄ν„°λ΅λ”

λ°μ΄ν„°μ„ΈνΈ: λ°μ΄ν„°μ μ§‘ν•©μ„ μλ―Έν•λ©°, μ…λ ¥κ°’(X)κ³Ό κ²°κ³Όκ°’(Y)μ— λ€ν• μ •λ³΄λ¥Ό μ κ³µν•κ±°λ‚ μΌλ ¨μ λ°μ΄ν„° λ¬¶μμ„ μ κ³µ
- κµ¬μ΅°: μΌλ°μ μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤(Database)μ ν…μ΄λΈ”(Table)κ³Ό κ°™μ€ ν•νƒ
- λ°μ΄ν„°μ„ΈνΈμ ν• ν¨ν„΄μ„ ν…μ΄λΈ”μ ν–‰(Row)μΌλ΅ κ°„μ£Όν•λ‹¤λ©΄, μ΄ ν–‰μ—μ„ λ°μ΄ν„°λ¥Ό λ¶λ¬μ™€ ν•™μµμ„ μ§„ν–‰

λ°μ΄ν„°μ κµ¬μ΅°λ‚ ν¨ν„΄μ€ λ§¤μ° λ‹¤μ–‘ν•λ©° ν•™μµν•΄μ•Ό ν•λ” λ°μ΄ν„°κ°€ νμΌ κ²½λ΅λ΅ μ κ³µλκ±°λ‚ λ°μ΄ν„°λ¥Ό ν™μ©ν•κΈ° μ„ν•΄μ„ μ „μ²λ¦¬ λ‹¨κ³„κ°€ ν•„μ”ν• κ²½μ°κ°€ μλ‹¤. λν• λ‹¤μ–‘ν• λ°μ΄ν„°κ°€ ν¬ν•¨λ λ°μ΄ν„°μ„ΈνΈμ—μ„λ” νΉμ •ν• ν•„λ“μ κ°’μ„ μ‚¬μ©ν•κ±°λ‚ μ‚¬μ©ν•μ§€ μ•μ„ μ μλ‹¤.

λ°μ΄ν„°λ¥Ό λ³€ν•ν•κ³  λ§¤ν•‘ν•λ” μ½”λ“λ¥Ό ν•™μµ κ³Όμ •μ— μ§μ ‘ λ°μν•λ©΄ **λ¨λ“ν™”(Modularization)**, **μ¬μ‚¬μ©μ„±(Reusable)**, **κ°€λ…μ„±(Readability)** λ“±μ„ λ–¨μ–΄λ¨λ¦¬λ” μ£Όμ” μ›μΈμ΄ λλ‹¤. μ΄λ¬ν• ν„μƒμ„ λ°©μ§€ν•κ³  μ½”λ“λ¥Ό κµ¬μ΅°μ μΌλ΅ μ„¤κ³„ν•  μ μλ„λ΅ λ°μ΄ν„°μ„ΈνΈμ™€ λ°μ΄ν„°λ΅λ”λ¥Ό μ‚¬μ©ν•λ‹¤.

### λ°μ΄ν…μ„ΈνΈ

**λ°μ΄ν„°μ„ΈνΈ(Dataset)**λ” ν•™μµμ— ν•„μ”ν• λ°μ΄ν„° μƒν”μ„ μ •μ ν•κ³  μ •λ‹µμ„ μ €μ¥ν•λ” κΈ°λ¥μ„ μ κ³µν•λ‹¤.
- μ΄κΈ°ν™” λ©”μ„λ“(`__init__`): μ…λ ¥λ λ°μ΄ν„°μ μ „μ²λ¦¬ κ³Όμ •μ„ μν–‰ν•λ” λ©”μ„λ“
  - μƒλ΅μ΄ μΈμ¤ν„΄μ¤κ°€ μƒμ„±λ  λ• ν•™μµμ— μ‚¬μ©λ  λ°μ΄ν„°λ¥Ό μ„ μ–Έν•κ³ , ν•™μµμ— ν•„μ”ν• ν•νƒλ΅ λ³€ν•ν•λ” κ³Όμ •μ„ μ§„ν–‰
- νΈμ¶ λ©”μ„λ“(`__getitem__`): ν•™μµμ„ μ§„ν–‰ν•  λ• μ‚¬μ©λλ” ν•λ‚μ ν–‰μ„ λ¶λ¬μ¤λ” κ³Όμ •
  - μ…λ ¥λ μƒ‰μΈ(index)μ— ν•΄λ‹Ήν•λ” λ°μ΄ν„° μƒν”μ„ λ¶λ¬μ¤κ³  λ°ν™
  - μ΄κΈ°ν™” λ©”μ„λ“μ—μ„ λ³€ν•λκ±°λ‚ κ°μ„ λ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ©°, λ°μ΄ν„° μƒν”κ³Ό μ •λ‹µμ„ λ°ν™
- κΈΈμ΄ λ°ν™ λ©”μ„λ“(`__len__`): ν•™μµμ— μ‚¬μ©λ μ „μ²΄ λ°μ΄ν„°μ„ΈνΈμ κ°μλ¥Ό λ°ν™
  - λ©”μ„λ“λ¥Ό ν†µν•΄ λ‡ κ°μ λ°μ΄ν„°λ΅ ν•™μµμ΄ μ§„ν–‰λλ”μ§€ ν™•μΈν•  μ μμ

```python
# λ°μ΄ν„°μ„ΈνΈ ν΄λμ¤ κΈ°λ³Έν•
class Dataset:

  def __init__(self, data, *arg, **kwargs):
    self.data = data
  
  def __getitem__(self, index):
    return tuple(data[index] for data in data.tensors)
  
  def __len__(self):
    return self.data[0].size(0)

```

λ¨λΈ ν•™μµμ„ μ„ν•΄ μ„μμ λ°μ΄ν„°μ„ΈνΈλ¥Ό κµ¬μ„±ν•  λ• νμ΄ν† μΉμ—μ„ μ§€μ›ν•λ” λ°μ΄ν„°μ„ΈνΈ ν΄λμ¤λ¥Ό μƒμ†λ°›μ•„ μ‚¬μ©ν•λ‹¤. μƒλ΅ μ •μν• λ°μ΄ν„°μ„ΈνΈ ν΄λμ¤λ” ν„μ¬ μ‹μ¤ν…μ— μ ν•©ν• κµ¬μ΅°λ΅ λ°μ΄ν„°λ¥Ό μ „μ²λ¦¬ν•΄ μ‚¬μ©ν•λ‹¤.

### λ°μ΄ν„°λ΅λ”

**λ°μ΄ν„°λ΅λ”(DataLoader)**λ” λ°μ΄ν„°μ„ΈνΈμ— μ €μ¥λ λ°μ΄ν„°λ¥Ό μ–΄λ– ν• λ°©μ‹μΌλ΅ λ¶λ¬μ™€ ν™μ©ν• μ§€ μ •μν•λ‹¤. ν•™μµμ„ μ΅°κΈ λ” μ›ν™ν•κ² μ§„ν–‰ν•  μ μλ„λ΅ μ—¬λ¬ κΈ°λ¥μ„ μ κ³µν•λ‹¤.
- λ°°μΉ ν¬κΈ°(batch_size): ν•™μµμ— μ‚¬μ©λλ” λ°μ΄ν„°μ κ°μκ°€ λ§¤μ° λ§μ•„ ν• λ²μ μ—ν­μ—μ„ λ¨λ“  λ°μ΄ν„°λ¥Ό λ©”λ¨λ¦¬μ— μ¬λ¦΄ μ μ—†μ„ λ• λ°μ΄ν„°λ¥Ό λ‚λ„λ” μ—­ν• μ„ ν•λ‹¤.
  - μ „μ²΄ λ°μ΄ν„°μ„ΈνΈμ—μ„λ°°μΉ ν¬κΈ°λ§νΌ λ°μ΄ν„° μƒν”μ„ λ‚λ„κ³ , λ¨λ“  λ°°μΉλ¥Ό λ€μƒμΌλ΅ ν•™μµμ„ μ™„λ£ν•λ©΄ ν• λ²μ μ—ν­μ΄ μ™„λ£
- λ°μ΄ν„° μμ„ λ³€κ²½(shuffle): λ°μ΄ν„°μ μμ„λ΅ ν•™μµλλ” κ²ƒμ„ λ°©μ§€
- λ°μ΄ν„° λ΅λ“ ν”„λ΅μ„Έμ¤ μ(num_workers): λ°μ΄ν„°λ¥Ό λ¶λ¬μ¬ λ• μ‚¬μ©ν•  ν”„λ΅μ„Έμ¤μ κ°μ

### λ‹¤μ¤‘ μ„ ν•νκ·€

λ°μ΄ν„°μ„ΈνΈμ™€ λ°μ΄ν„°λ΅λ”λ¥Ό ν™μ©ν•΄ λ‹¤μ¤‘ μ„ ν•νκ·€λ¥Ό κµ¬ν„ν•λ©΄ μ•„λμ™€ κ°™μ΄ κµ¬ν„ν•  μ μλ‹¤.

```python
import torch
from torch import nn
from torch import optim
from torch.utils.data import TensorDataset, DataLoader

# κΈ°λ³Έ λ°μ΄ν„° κµ¬μ΅° μ„ μ–Έ
train_x = torch.FloatTensor([
  [1, 2], [2, 3], [3, 4], [4, 5], [5, 6], [6, 7]
])
train_y = torch.FloatTensor([
  [0.1, 1.5], [1, 2.8], [1.9, 4.1], [2.8, 5.4], [3.7, 6.7], [4.6, 8]
])

# λ°μ΄ν„°μ„ΈνΈμ™€ λ°μ΄ν„°λ΅λ”
train_dataset = TensorDataset(train_x, train_y)
train_dataloader = DataLoader(train_dataset, batch_size=2, shuffle=True, drop_last=True)

# λ¨λΈ, μ¤μ°¨ ν•¨μ, μµμ ν™” ν•¨μ μ„ μ–Έ
model = nn.Linear(2, 2, bias=True)
criterion = nn.MSELoss()
optimizer = optim.SGD(model.parameters(), lr=0.001)

# λ°μ΄ν„°λ΅λ” μ μ©
for epoch in range(20000):
  cost = 0.0
  for batch in train_dataloader:
    x, y = batch
    output = model(x)

    loss = criterion(output, y)
    loss.backward()
    optimizer.step()

    cost += loss

  cost = cost / len(train_dataloader)

  if (epoch + 1) % 1000 == 0:
    print(f"Epoch: {epoch+1:4d}, Model: {list(model.parameters())}, Cost: {cost:.3f}")
```

μ‹¤μ  ν™κ²½μ—μ„ μ μ©λλ” λ°μ΄ν„°(ν•™μµμ— μ‚¬μ©ν•μ§€ μ•μ€ λ°μ΄ν„°)λ¥Ό ν†µν•΄ μ§€μ†μ μΌλ΅ κ²€μ¦ν•κ³ , μµμ μ λ§¤κ°λ³€μλ¥Ό μ°Ύλ” λ°©λ²•μΌλ΅ λ¨λΈμ„ κµ¬μ„±ν•΄μ•Ό ν•λ‹¤. μ΄ μ΄μ λ΅ λ°μ΄ν„°μ κµ¬μ΅°λ‚ ν•νƒλ” μ§€μ†ν•΄μ„ λ³€κ²½λ  μ μμΌλ―€λ΅ λ°μ΄ν„°μ„ΈνΈμ™€ λ°μ΄ν„°λ΅λ”λ¥Ό ν™μ©ν•΄ μ½”λ“ ν’μ§μ„ λ†’μ΄κ³  λ°λ³µ λ° λ³€κ²½λλ” μ‘μ—…μ— λ€ν•΄ λ” ν¨μ¨μ μΌλ΅ λ€μ²ν•΄μ•Όν•λ‹¤.

## π¦¥ λ¨λΈ/λ°μ΄ν„°μ„ΈνΈ λ¶„λ¦¬