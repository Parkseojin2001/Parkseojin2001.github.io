<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <style> 
      ::-webkit-scrollbar{ 
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        width: 0px;
        background-color: rgba(224, 224, 224, 0.2);
        /* border-radius: 5px; */
      }

      ::-webkit-scrollbar-thumb {
        width: 0px;
        background-color: rgba(220, 219, 218, 0.6);
        border-radius: 5px;
      }

      ::-webkit-scrollbar-thumb:hover {
        width: 10px;
        height: 20px;
        /* background-color: rgba(190, 190, 190, 0.2); */
        background-color: rgba(193, 192, 191, 0.7);
        border-radius: 5px;
      }

      ::-webkit-scrollbar-track:hover {
        width: 10px;
        /* background-color: rgba(150, 150, 150, 0.1); */
        background-color: rgba(224, 224, 224, 0.5);
        border-radius: 5px;
        /* background: transparent; */
        /* border-radius: 10px; */
      }

      ::-webkit-scrollbar-button:start:decrement,::-webkit-scrollbar-button:end:increment {
          width:0px;
          height: 0px;
          /* background-color: rgb(14, 221, 24); */
          /* border-radius: 50%; */
      }
    </style>
    
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>파이토치 기초(1) | Seojin</title>
<meta name="description" content="텐서 / 가설 / 손실 함수 / 최적화">


  <meta name="author" content="Seojin">
  
  <meta property="article:author" content="Seojin">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="Seojin Devlog">
<meta property="og:title" content="파이토치 기초(1)">
<meta property="og:url" content="http://localhost:4000/pytorch/basic-1/">


  <meta property="og:description" content="텐서 / 가설 / 손실 함수 / 최적화">







  <meta property="article:published_time" content="2025-03-31T00:00:00+09:00">



  <meta property="article:modified_time" content="2025-04-28T00:00:00+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/pytorch/basic-1/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Seojin",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Seojin Devlog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      processEscapes: true
    }
  });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->


    <link rel="apple-touch-icon" sizes="180x180" href="https://Parkseojin2001.github.io/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://Parkseojin2001.github.io/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://Parkseojin2001.github.io/assets/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://Parkseojin2001.github.io/assets/images/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://Parkseojin2001.github.io/assets/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Seojin Devlog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://Parkseojin2001.github.io/">Home</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/Parkseojin2001">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/meee.png" alt="Seojin" itemprop="image">
      
    </div>
  

  <!-- 2022.02.17 author content hidden -->
  <!-- <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Seojin</h3>
    
    
  </div> -->

  <div class="author__urls-wrapper">
    <!-- <button class="btn btn--inverse">Follow</button> -->
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    <!-- <li>
      <span class="nav__total">🌴 Total Posts: 25</span>
    </li> -->
    
    
      <li>
        
          <!-- title -->
              <span class="nav__sub-title">COMPUTER SCIENCE</span>
              <hr>
        

        
        <ul>
          
            <!-- sub-title -->
            
              
            
              
                <li><a href="/categories/data-structure/">Data Structure (4)</a></li>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
                <li><a href="/categories/algorithm/">Algorithm (1)</a></li>
              
            
              
            
              
            
              
            
              
            
              
            
          
            <!-- sub-title -->
            
              
                <li><a href="/categories/os/">Operating System (1)</a></li>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
        </ul>
        
      </li>
    
      <li>
        
          <!-- title -->
              <span class="nav__sub-title">AI</span>
              <hr>
        

        
        <ul>
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <li><a href="/categories/pytorch/">Pytorch (2)</a></li>
              
            
              
            
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
            <!-- sub-title -->
            
              
            
              
            
              
                <li><a href="/categories/hands-on/">핸즈온 머신러닝 (7)</a></li>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <li><a href="/categories/nlp/">NLP (5)</a></li>
              
            
              
            
              
            
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
        </ul>
        
      </li>
    
      <li>
        
          <!-- title -->
              <span class="nav__sub-title">PROGRAMMING</span>
              <hr>
        

        
        <ul>
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
                <li><a href="/categories/python/">Python (2)</a></li>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
        </ul>
        
      </li>
    
      <li>
        
          <!-- title -->
              <span class="nav__sub-title">AWS</span>
              <hr>
        

        
        <ul>
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <li><a href="/categories/aws-saa/">AWS SAA (1)</a></li>
              
            
          
        </ul>
        
      </li>
    
      <li>
        
          <!-- title -->
              <span class="nav__sub-title">PROJECT</span>
              <hr>
        

        
        <ul>
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <li><a href="/categories/capstone-design/">Capstone Design (1)</a></li>
              
            
              
            
              
            
              
            
          
        </ul>
        
      </li>
    
      <li>
        
          <!-- title -->
              <span class="nav__sub-title">GIT</span>
              <hr>
        

        
        <ul>
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
                <li><a href="/categories/git/">Git (1)</a></li>
              
            
              
            
              
            
              
            
              
            
          
            <!-- sub-title -->
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="파이토치 기초(1)">
    <meta itemprop="description" content="텐서 / 가설 / 손실 함수 / 최적화">
    <meta itemprop="datePublished" content="2025-03-31T00:00:00+09:00">
    <meta itemprop="dateModified" content="2025-04-28T00:00:00+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">파이토치 기초(1)
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2025-03-31T00:00:00+09:00">March 31, 2025</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#-텐서">🦥 텐서</a><ul><li><a href="#텐서-생성">텐서 생성</a></li><li><a href="#텐서-속성">텐서 속성</a></li><li><a href="#차원-변환">차원 변환</a></li><li><a href="#자료형-설정">자료형 설정</a></li><li><a href="#장치-설정">장치 설정</a></li><li><a href="#장치-변환">장치 변환</a></li><li><a href="#넘파이-배열의-텐서-변환">넘파이 배열의 텐서 변환</a></li><li><a href="#텐서의-넘파이-배열-변환">텐서의 넘파이 배열 변환</a></li></ul></li><li><a href="#-가설">🦥 가설</a><ul><li><a href="#머신러닝에서의-가설">머신러닝에서의 가설</a></li><li><a href="#통계적-가설-검정-사례">통계적 가설 검정 사례</a></li></ul></li><li><a href="#-손실-함수">🦥 손실 함수</a><ul><li><a href="#제곱-오차">제곱 오차</a></li><li><a href="#오차-제곱합">오차 제곱합</a></li><li><a href="#평균-제곱-오차">평균 제곱 오차</a></li><li><a href="#교차-엔트로피">교차 엔트로피</a></li></ul></li><li><a href="#-최적화">🦥 최적화</a><ul><li><a href="#경사-하강법">경사 하강법</a><ul><li><a href="#가중치-갱신-방법">가중치 갱신 방법</a></li></ul></li><li><a href="#학습률">학습률</a></li><li><a href="#최적화-문제">최적화 문제</a></li><li><a href="#단순-선형-회귀-넘파이">단순 선형 회귀: 넘파이</a></li><li><a href="#단순-선형-회귀-파이토치">단순 선형 회귀: 파이토치</a><ul><li><a href="#zero_grad-costbackward-optimizerstep">zero_grad(), cost.backward(), optimizer.step()</a></li></ul></li><li><a href="#신경망-패키지">신경망 패키지</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <h2 id="-텐서">🦥 텐서</h2>

<p><strong>텐서(Tensor)</strong>란 넘파이 라이브러리의 ndarray 클래스와 유사한 구조로 <strong>배열(Array)</strong>이나 <strong>행렬(Matrix)</strong>과 유사한 자료 구조(자료형)다. 파이토치에서는 텐서를 사용하여 모델의 입출력뿐만 아니라 모델의 매개변수를 부호화(Encode)하고 GPU를 활용해 연산을 가속화할 수 있다.</p>

<p>넘파이와 파이토치<br /></p>
<ul>
  <li>공통점: 수학 계산, 선형 대수 연산을 비롯해 전치(Tranposing), 인덱싱(Indexing), 슬라이싱(Slicing), 임의 샘플링(Random Sampling) 등 다양한 텐서 연산을 진행할 수 있다.</li>
  <li>차이점: 파이토치는 <strong>GPU 가속(GPU Acceleration)</strong>을 적용할 수 있어 CPU 텐서와 GPU 텐서로 나눠지고, 각각의 텐서를 상호 변환하거나 GPU 사용 여부를 설정한다.</li>
</ul>

<p>텐서의 형태를 시각화하면 다음과 같다.</p>

<p><img src="https://raw.githubusercontent.com/HiddenBeginner/hiddenbeginner.github.io/master/static/img/_posts/2020-1-21-pytorch_tensor/figure1.png" /></p>

<ul>
  <li>스칼라(Scalar): 크기만 있는 물리량이지만, 0차원 텐서라고 부른다. 모든 값의 기본 형태로 볼 수 있으며 차원은 없다.</li>
  <li>벡터(Vector): 스칼라 값들을 하나로 묶은 형태로 간주할 수 있으며 <strong>(N, )</strong>의 차원을 갖는다.
    <ul>
      <li>[1, 2, 3]과 같은 형태로, 파이썬에서 많이 사용하는 1차원 리스트와 비슷하다.</li>
    </ul>
  </li>
  <li>행렬(Matrix):  벡터값들을 하나로 묶은 형태로 간주할 수 있으며 <strong>(N, M)</strong>으로 표현한다.
    <ul>
      <li>[[1, 2, 3], [4, 5, 6]]과 같은 형태로 회색조(Grayscale) 이미지를 표현하거나 좌표계(Coordinate System)로도 활용될 수 있다.</li>
    </ul>
  </li>
  <li>배열(Array): 3차원 이상의 배열을 모두 지칭하며, 각각의 차원을 구별하기 위해 N 차원 배열 또는 N 차원 텐서로 표현한다. 즉, 행렬을 세 개 생성해 겹쳐 놓은 구조로 볼 수 있다.
    <ul>
      <li>배열의 경우 이미지를 표현하기에 가장 적합한 형태를 띤다.</li>
      <li>이미지의 경우 (C, H, W)로 표현하며, C는 채널, H는 이미지의 높이, W는 이미지의 너비가 된다.</li>
    </ul>
  </li>
  <li>4차원 배열: 3차원 배열들을 하나로 묶은 형태이므로 이미지 여러 개의 묶음으로 볼 수 있다. 파이토치를 통해 이미지 데이터를 학습시킬 때 주로 4차원 배열 구조의 형태로 가장 많이 사용한다.
    <ul>
      <li>이미지의 경우 (N, C, H, W)로 표현한다. N의 경우 이미지의 개수를 의미한다.</li>
    </ul>
  </li>
</ul>

<h3 id="텐서-생성">텐서 생성</h3>

<p>텐서 생성 방법은 <code class="language-plaintext highlighter-rouge">torch.tensor()</code> 또는 <code class="language-plaintext highlighter-rouge">torch.Tensor()</code>로 생성할 수 있다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">torch.tensor()</code> : <strong>입력된 데이터를 복사해 텐서로 변환</strong>하는 함수이다. 즉, 데이터를 복사하기 때문에 값이 무조건 존재해야 하며 입력된 데이터 형식에 가장 작합한 텐서 자료형으로 변환한다.</li>
  <li><code class="language-plaintext highlighter-rouge">torch.Tensor()</code> : <strong>텐서의 기본형으로 텐서 인스턴스를 생성하는 클래스</strong>다. 인스턴스를 생성하기 때문에 값을 입력하지 않는 경우 비어 있는 텐서를 생성한다.</li>
</ul>

<p>가능한 자료형이 명확하게 표현되는 클래스 형태의 <code class="language-plaintext highlighter-rouge">torch.Tensor()</code>를 사용하는 것을 권장한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 텐서 생성
</span><span class="kn">import</span> <span class="nn">torch</span>

<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">LongTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>

<span class="c1"># tensor([1, 2, 3])
# tensor([[1., 2., 3.],
#         [4., 5., 6.]])
# tensor([1, 2, 3])
# tensor([1., 2., 3.])
</span></code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">torch.tensor()</code>는 자동으로 자료형을 할당하므로 입력된 데이터 형식을 참조해 Int 형식으로 할당</li>
  <li><code class="language-plaintext highlighter-rouge">torch.Tensor()</code>는 입력된 데이터 형식이 Int형이지만 Float 형식으로 생성됐는데, 이는 기본 유형이 Float이므로 소수점 형태로 변환</li>
  <li><code class="language-plaintext highlighter-rouge">torch.LongTensor()</code>, <code class="language-plaintext highlighter-rouge">torch.FloatTensor()</code>, <code class="language-plaintext highlighter-rouge">torch.IntTensor()</code> 모두 데이터 형식이 미리 선언된 클래스다.</li>
</ul>

<h3 id="텐서-속성">텐서 속성</h3>

<p>텐서의 속성은 크게 <strong>형태(shape), 자료형(dtype), 장치(device)</strong>가 존재한다.</p>
<ul>
  <li>형태: 텐서의 차원을 의미</li>
  <li>자료형: 텐서에 할당된 데이터 형식</li>
  <li>장치: 텐서의 GPU 가속 여부를 의미</li>
</ul>

<p>텐서 연산을 진행할 때 위의 세 가지 속성이 모두 맞아야 작동이 된다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">.</span><span class="n">device</span><span class="p">)</span>

<span class="c1"># tensor([[0.8522, 0.3964]])
# torch.Size([1, 2])
# torch.float32
# cpu
</span></code></pre></div></div>

<h3 id="차원-변환">차원 변환</h3>

<p>차원 변환은 가장 많이 사용되는 메서드 중 하나로 머신러닝 연산 과정이나 입출력 변환 등에 많이 활용된다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 텐서 차원 변환
</span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># tensor([[0.6499, 0.3419]])
# torch.Size([1, 2])
# tensor([[0.6499],
#         [0.3419]])
# torch.Size([2, 1])
</span></code></pre></div></div>

<p>텐서의 차원 변환은 <code class="language-plaintext highlighter-rouge">reshape()</code> 메서드를 활용할 수 있다.</p>

<h3 id="자료형-설정">자료형 설정</h3>

<p>텐서에 있어서 자료형은 가장 중요한 요소다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 텐서 자료형 설정
</span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="nb">float</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>

<span class="c1"># tensor([[0.6837, 0.7457, 0.9212],
#         [0.3221, 0.9590, 0.1553],
#         [0.7908, 0.4360, 0.7417]])
</span></code></pre></div></div>

<p>텐서의 자료형 설정에 입력되는 인수는 <code class="language-plaintext highlighter-rouge">torch.*</code> 형태로 할당한다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">torch.float</code>는 32비트 부동 소수점 형식을 갖지만, <code class="language-plaintext highlighter-rouge">float</code>은 64비트 부동 소수점을 갖는다. 이는 메모리 필요를 줄일 수 있다.</li>
</ul>

<h3 id="장치-설정">장치 설정</h3>

<p>장치 설정을 정확하게 할당하지 않으면 <strong>실행 오류(Runtime Error)</strong>가 발새하거나 CPU 연산이 되어 학습하는 데 오랜 시간이 소요된다. 그러므로 모델 학습을 하기 전에 장치 설정을 확인하는 과정이 필요하다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 텐서 GPU 장치 설정
</span><span class="kn">import</span> <span class="nn">torch</span> 

<span class="n">device</span> <span class="o">=</span> <span class="s">'cuda'</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s">'cpu'</span>
<span class="n">cpu</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">gpu</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cpu</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gpu</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>

<span class="c1"># cuda
# tensor([1., 2., 3.])
# tensor([1., 2., 3.], device='cuda:0')
# tensor([[0.1998]], device='cuda:0')
</span></code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">torch.cuda.is_available()</code>: CUDA 사용 여부를 확인할 수 있는 함수</li>
</ul>

<p>애플 실리콘에서는 MPS를 통한 GPU 가속을 적용한다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">device = "mps" if torch.backends.mps.is_available() and torch.backends.mps.is_built() else "cpu"</code></li>
</ul>

<h3 id="장치-변환">장치 변환</h3>

<p>CPU 장치를 사용하는 텐서와 GPU 장치를 사용하는 텐서는 상호 간 연산이 불가능하다. 하지만 CPU 장치를 사용하는 텐서와 넘파이 배열 간 연산은 가능하며, GPU 장치를 사용하는 텐서와 넘파이 배열 간 연산은 불가능하다.</p>

<p>넘파이 배열 데이터를 학습에 활용하려면 GPU 장치로 변환해야한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 텐서 장치 변환
</span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">cpu</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">gpu</span> <span class="o">=</span> <span class="n">cpu</span><span class="p">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">gpu2cpu</span> <span class="o">=</span> <span class="n">gpu</span><span class="p">.</span><span class="n">cpu</span><span class="p">()</span>
<span class="n">cpu2gpu</span> <span class="o">=</span> <span class="n">cpu</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="s">"cuda"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cpu</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gpu</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gpu2cpu</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gpu2cpu</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cpu2gpu</span><span class="p">)</span>

<span class="c1"># tensor([1., 2., 3.])
# tensor([1., 2., 3.], device='cuda:0')
# tensor([1., 2., 3.])
# tensor([1., 2., 3.], device='cuda:0')
</span></code></pre></div></div>

<p><strong>장치(device)</strong> 간 상호 변환은 cuda와 cpu 메서드를 통해 할 수 있다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">cuda()</code>: CPU 장치로 선언된 값을 GPU로 변환 가능</li>
  <li><code class="language-plaintext highlighter-rouge">cpu()</code>: GPU 장치로 선언된 값을 CPU로 변환</li>
  <li><code class="language-plaintext highlighter-rouge">to()</code>: 장치를 간단하게 변환(MPS 장치로 변환도 가능)</li>
</ul>

<h3 id="넘파이-배열의-텐서-변환">넘파이 배열의 텐서 변환</h3>

<p>넘파이나 다른 라이브러리의 데이터를 파이토치에 활용하려면 텐서 형식으로 변환해야 한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 넘파이 배열의 텐서 변환
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ndarray</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">ndarray</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">ndarray</span><span class="p">))</span>

<span class="c1"># tensor([1, 2, 3], dtype=torch.uint8)
# tensor([1., 2., 3.])
# tensor([1., 2., 3.])
# tensor([1, 2, 3], dtype=torch.uint8)
</span></code></pre></div></div>

<h3 id="텐서의-넘파이-배열-변환">텐서의 넘파이 배열 변환</h3>

<p>텐서를 넘파이 배열로 변환하는 방법은 추론된 결과를 후처리하거나 결과값을 활용할 때 주로 사용된다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 텐서의 넘파이 배열 변환
</span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">ndarray</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">.</span><span class="n">detach</span><span class="p">().</span><span class="n">cpu</span><span class="p">().</span><span class="n">numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">ndarray</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ndarray</span><span class="p">))</span>

<span class="c1"># [1, 2, 3,]
# &lt;class 'numpy.ndarray'&gt;
</span></code></pre></div></div>

<p>텐서는 기존 데이터 형식과 다르게 학습을 위한 데이터 형식으로 모든 연산을 추적해 기록한다. 이 기록을 통해 <strong>역전파(Backpropagation)</strong> 등과 같은 연산이 진행돼 모델 학습이 이뤄진다.</p>

<p>텐서를 넘파이 배열로 변환할 때는 <code class="language-plaintext highlighter-rouge">detach()</code> 메서드를 적용한다. 이 메서드는 현재 연산 그래프에서 분리된 새로운 텐서를 반환한다.</p>

<h2 id="-가설">🦥 가설</h2>

<p><strong>가설(Hypothesis)</strong>이란 어떤 사실을 설명하거나 증명하기 위한 가정으로 두 개 이상의 변수의 관계를 검증 가능한 형태로 기술하여 변수 간의 관계를 예측하는 것을 의미한다. 가설은 어떠한 현상에 대해 이론적인 근거를 토대로 통계적 모형을 구축하며, 데이터를 수집해 해당 현상에 대한 데이터의 정확한 특성을 식별해 검증한다.</p>

<ul>
  <li><strong>연구가설(Research Hypothesis)</strong>: 연구자가 설명하려는 가설로 귀무가설을 부정하는 것으로 설정한 가설을 증명하려는 가성</li>
  <li><strong>귀무가설(Null Hypothesis)</strong>: 처음부터 버릴 것을 예상하는 가설이며 변수 간 차이나 관계가 없음을 통계학적 증거를 통해 증명하려는 가설</li>
  <li><strong>대립가설(Alternative Hypothesis)</strong>: 귀무가설과 반대되는 가설로, 귀무가설이 거짓이라면 대안으로 참이 되는 가설이다. 즉, 대립가설은 연구가설과 동일하다고 볼 수 있으며 이를 통해 <strong>통계적 가설 검정(Statistical Hypothesis Test)</strong>을 진행</li>
</ul>

<h3 id="머신러닝에서의-가설">머신러닝에서의 가설</h3>

<p>머신러닝에서의 가설은 통계적 가설 검정이 되며, 데이터와 변수 간의 관계가 있는지 확률론적으로 설명하게 된다. 즉, 머신러닝에서의 가설은 독립 변수(X)와 종속 변수(Y)를 가장 잘 매핑시킬 수 있는 기능을 학습하기 위해 사용한다. 그러므로 <strong>독립 변수와 종속 변수 간의 관계를 가장 잘 근사(Approximation)시키기 위해 사용된다.</strong></p>

<p>가설은 <strong>단일 가설(Single Hypothesis)</strong>과 <strong>가설 집합(Hypothesis Set)</strong>으로 표현할 수 있다.</p>
<ul>
  <li>단일 가설: 입력을 출력에 매핑하고 평가하고 예측하는 데 사용할 수 있는 단일 시스템을 의미
    <ul>
      <li>$h$로 표현</li>
    </ul>
  </li>
  <li>가설 집합: 출력에 입력을 매핑하기 위한 <strong>가설 공간(Hypothesis Space)</strong>으로, 모든 가설을 의미
    <ul>
      <li>$H$로 표현</li>
    </ul>
  </li>
</ul>

<p>임의의 독립 변수(X)와 종속 변수(Y)의 값과 그 값을 시각화하면 다음과 같다.</p>

<p><img src="https://github.com/user-attachments/assets/2c4cc9d6-f65f-4235-8fc0-938c3fa8ef49" width="600px" height="600px" /></p>

<p>파란색 점은 임의의 데이터이고 붉은색 선은 가설을 의미하며 선형 회귀를 통해 계산된 값이며, 수식으로 나타내면 다음과 같다.</p>
<ul>
  <li>수학적 표현: $y=ax+b$
    <ul>
      <li>$a$: 기울기</li>
      <li>$b$: 절편</li>
    </ul>
  </li>
  <li>머신러닝 표현: $H(x)=Wx + b$
    <ul>
      <li>$H(x)$: 가설(Hypothesis)</li>
      <li>$W$: 가중치(Weight)</li>
      <li>$b$: 편향(Bias)</li>
    </ul>
  </li>
</ul>

<p>가설은 회귀 분석과 같은 알고리즘을 통해 최적의 가중치와 편향을 찾는 과정이며 학습이 진행될 때마다 가중치와 편향이 지속해서 바뀌게 된다.</p>

<p>마지막으로 학습이 된 결과를 <strong>모델(Model)</strong>이라 부르며, 이 모델을 통해 새로운 입력에 대한 결과값을 <strong>예측(Prediction)</strong>한다.</p>

<h3 id="통계적-가설-검정-사례">통계적 가설 검정 사례</h3>

<p>대표적인 통계적 가설 검정은 <strong>t-검정(t-test)</strong>이 있으며, 두 가지 범주로 더 세분화할 수 있다.</p>
<ul>
  <li>쌍체 t-검정(paired t-test): 동일한 항목 또는 그룹을 두 번 테스트할 때 사용
    <ul>
      <li>ex. 동일 집단에 대한 약물 치료 전후 효과 검정, 동일 집단에 대한 학습 방법 전후 효과 검정에 활용</li>
    </ul>
  </li>
  <li>비쌍체 t-검정(unpaired t-test): <strong>등분산성(homoskedasticity)</strong>을 만족하는 두 개의 독립적인 그룹 간의 평균을 비교하는 데 사용
    <ul>
      <li>ex. 제약 연구에서 서로 다른 두 개의 독립적인 집단(실험군, 대조군) 간에 유의미한 차이가 있는지 조사</li>
    </ul>
  </li>
</ul>

<p><strong>머신러닝의 통계적 가설을 적용한다면 비쌍체 t-검정을 사용해야 한다.</strong></p>
<ul>
  <li>독립 변수(X)와 종속 변수(Y) 사이에 유의미한 차이가 있는지 검정
    <ul>
      <li>변수들의 샘플 데이터는 <strong>독립항등분포(independent and identically distributed)</strong>를 따름</li>
    </ul>
  </li>
</ul>

<p>ex. 사람의 키(cm)가 성별과 관련 있는지 비쌍체 t-검정을 수행</p>
<ul>
  <li>귀무가설: $\mu_{man} = \mu_{woman}$</li>
  <li>대립가설: $\mu_{man} \not= \mu_{woman}$</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 성별에 따른 키 차이 검정
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">man_height</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">170</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">woman_height</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">man_height</span><span class="p">,</span> <span class="n">woman_height</span><span class="p">])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="s">"man"</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">man_height</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s">"woman"</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">woman_height</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"X"</span><span class="p">,</span> <span class="s">"Y"</span><span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"X"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"Y"</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"kde"</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s">"cm"</span><span class="p">,</span> <span class="s">"count"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://github.com/user-attachments/assets/cb5c3a11-d72e-4625-bd6b-902806db6ed5" width="400px" height="400px" /></p>

<p><code class="language-plaintext highlighter-rouge">stats.norm.rvs</code>는 <strong>특정 평균(loc)</strong>과 <strong>표준편차(scale)</strong>를 따르는 분포에서 데이터를 샘플링하는 함수이다.</p>
<ul>
  <li>남성(man)의 평균 키가 여성(woman)의 평균 키보다 높다는 것을 확인할 수 있다.</li>
</ul>

<p>통계적으로 키(Y)가 성별 차이(X)에 유의미한 요소인지 <strong>비쌍체 t-검정</strong>으로 확인할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 비쌍체 t-검정
</span><span class="n">statistic</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">man_height</span><span class="p">,</span> <span class="n">woman_height</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"statistic: "</span><span class="p">,</span> <span class="n">statistic</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"pvalue: "</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"*: "</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"**: "</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">)</span>

<span class="c1"># statistic: 31.96162891312776
# pvalue: 6.2285854381989205e-155
# *: True
# **: True
</span></code></pre></div></div>

<p>성별 차이에 대한 유의미성을 판단하기 위해 <strong>통계량(statistic)</strong> 또는 <strong>유의 확률(pvalue)</strong>을 확인한다.</p>
<ul>
  <li>통계량이 크고 유의 확률이 작도면 귀무가설이 참일 확률이 낮다.(=’ 남녀 키의 평균이 서로 같다.’의 확률이 낮다고 할 수 있음)</li>
  <li>유의 확률이 0.05보다 작으면 <code class="language-plaintext highlighter-rouge">*</code>표기로 유의하다고 간주</li>
  <li>유의 확률이 0.001보다 작으면 <code class="language-plaintext highlighter-rouge">**</code>표기로 더 많이 유의하다고 판다.</li>
</ul>

<p>출력 결과의 유의 확률(pvalue)이 매우 작기 때문에 사람의 키(X)가 성별을 구분하는 데 매우 유의미한 변수라는 것을 확인할 수 있다.</p>

<h2 id="-손실-함수">🦥 손실 함수</h2>

<p><strong>손실 함수(Loss Function)</strong>는 단일 샘플의 실제값과 예측값의 차이가 발생했을 때 오차가 얼마인지 계산하는 함수를 의미한다. 인공 신경망은 <strong>실제값과 예측값을 통해 계산된 오차값을 최소화해 정확도를 높이는 방법으로 학습이 진행된다.</strong> 이때 각 데이터의 오차를 계산하는데, 이떄 손실 함수를 사용한다. 다른 말로는 <strong>목적함수(Objective Function)</strong>, <strong>비용함수(Cost Function)</strong>라고 부르기도 한다.</p>

<ul>
  <li>목적함수: 함숫값의 결과를 최댓값과 최솟값으로 최적화하는 함수</li>
  <li>비용 함수: 전체 데이터에 대한 오차를 계산하는 함수</li>
</ul>

<p>포함 관계는 <strong>$손실 함수 \in 비용 함수 \in 목적 함수$</strong>의 포함 관계를 갖는다.</p>

<p><img src="https://github.com/user-attachments/assets/0342cf81-cb58-4db4-87c4-947353f2dbe9" width="600px" height="500px" /></p>

<p>모집단에서 X의 값을 $H(x) = Wx + b$에 넣어 값을 구하면 예측값이 되며, 오차는 (실제값 - 예측값)이 된다.</p>

<p>오차를 통해 예측값이 얼마나 실제값을 잘 표현하는지 알 수 있다. 하지만 개별 데이터에 대한 오차를 확인할 수 있는 방법으로 가설이 얼마나 실제값을 정확하게 표현하는지는 알 수 없다. 그러므로 실제값을 가설이 얼마나 잘 표현하는지 계산해야한다.</p>

<h3 id="제곱-오차">제곱 오차</h3>

<p><strong>제곱 오차(Squared Error, SE)</strong>는 실제값에서 예측값을 뺀 값의 제곱을 의미한다.</p>

\[SE = (Y_i - \hat{Y_i})^2\]

<ul>
  <li>오차의 방향보다는 오차의 크기가 중요하여 제곱을 취함</li>
  <li>절댓값이 아닌 제곱을 취하는 이유는 오차가 큰 값을 더 두드러지게 확대시키기 떄문에 오차의 간극을 빠르게 확인</li>
</ul>

<h3 id="오차-제곱합">오차 제곱합</h3>

<p><strong>오차 제곱합(Sum of Squared for Error,SSE)</strong>은 제곱 오차를 모두 더한 값을 의미한다.</p>

\[SSE = \sum_{i=1}^{n}(Y_i - \hat Y_{i})^2\]

<h3 id="평균-제곱-오차">평균 제곱 오차</h3>

<p><strong>평균 제곱 오차(Mean Squared Error, MSE)</strong> 방법은 단순하게 오차 제곱합에서 평균을 취하는 방법이다. 평균값을 사용하지 않는 경우 오차가 많은 것인지 데이터가 많은 것인지 구분하기가 어려워지므로 모든 데이터의 개수만큼 나누어 평균을 계산한다.</p>

\[MSE = \frac{1}{n} \sum_{i=1}^{n}(Y_i - \hat Y_{i})^2\]

<p>평균 제곱 오차는 가설의 품질을 측정할 수 있으며, 오차가 0에 가까워질수록 높은 품질을 갖게 된다. 주로 회귀 분석에서 많이 사용되는 손실 함수이며, <strong>최대 신호 대 잡음비(Peak Signal-to-noise ratio, PSNR)</strong>를 계산할 때도 사용된다.</p>

<p>MSE에 루트(Root)를 씌우는 경우에는 <strong>평균 제곱근 오차(Root Mean Squared Error, RMSE)</strong>가 된다. 루트를 통해 평균 제곱 오차에서 발생한 왜곡을 감소시키면 정밀도(Precision)를 표현하기에 적합한 형태가 된다.</p>

<p align="center">
  <img src="https://blog.kakaocdn.net/dn/YvRRy/btqAtCSCC75/WMnm0mFII4kUa87E4Aw3o1/img.jpg" width="200px" height="100px" />
</p>

<p>단, 오차에 제곱을 적용해 오차량이 큰 값을 크기 부풀렸기 때문에 왜곡이 발생한다.</p>

<h3 id="교차-엔트로피">교차 엔트로피</h3>

<p><strong>교차 엔트로피(Cross-Entropy)</strong>는 이산형 변수를 위한 손실 함수이다. 교차 엔트로피는 실제값의 확률분포와 예측값의 확률분포 차이를 계산한다.</p>

\[CE(y, \hat y) = -\sum_j y_jlog \hat{y_j}\]

<ul>
  <li>실제 확률분포: $y$</li>
  <li>예측된 확률분포: $\hat y$</li>
</ul>

<p><img src="https://github.com/user-attachments/assets/ebabc6a6-78f4-4c24-a696-1b425e52ac80" /></p>

<h2 id="-최적화">🦥 최적화</h2>

<p><strong>최적화(Optimization)</strong>란 손실(목적) 함수의 결과값을 최적화하는 변수를 찾는 알고리즘을 의미한다. 손실 함수의 값을 최소가 되는 변수를 찾는다면 새로운 데이터에 대해 더 정교한 예측을 할 수 있다.</p>

<p>최적화 알고리즘은 실제값과 예측값의 차이를 계산해 오차를 최소로 줄일 수 있는 가중치와 편향을 계산한다.</p>

<p>여기서 최적의 가중치와 편향을 갖는 가설은 오차값이 0에 가까운 함수가 되며 이는 가중치와 오차에 대한 도함수의 변화량이 0에 가깝다는 의미다. 즉, 가중치와 오차에 대한 그래프의 <strong>극값(Extreme Value)</strong>이 가설을 가장 잘 표현하는 가중치와 오차가 된다.</p>

<ul>
  <li>
    <p>가설
$H(x) = wx + b$</p>
  </li>
  <li>
    <p>손실함수<br />
\((y - \hat{y})^2 = {y - (wx + b)}^2 \\
= y^2 - 2y(wx+b) + (wx + b)^2 \\
= w^2x^2 + 2wxb + b^2 - 2wxy - 2yb + y^2\)</p>
  </li>
</ul>

<p>위의 식에서 변수는 w이므로, 위 함수는 <strong>1개의 최적해를 갖는 이차 함수 형태</strong>인 것을 알 수 있다.<br />
그러므로, 손실함수의 개형은 아래와 같다.</p>

<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fcc2zk9%2FbtrgYk2fPpH%2FGsIYRrVKWDysknVajYNK81%2Fimg.png" /></p>

<p>손실함수의 그래프에서 <strong>기울기(Gradient)</strong>가 0에 가까워질 때 최적의 가중치를 갖는 것을 알 수 있다.</p>

<p>기울기가 0인 지점을 향해 이동을 해야한다. 이 떄 현재 지점에서 0으로 가기 위해서 어느 방향으로 얼마나 아동을 해야 하는지 알 수 없기 때문에 최적화 방법을 사용한다.</p>

<h3 id="경사-하강법">경사 하강법</h3>

<p><strong>경사 하강법(Gradient Descent)</strong>이란 함수의 기울기가 낮은 곳으로 계속 이동시켜 극값에 도달 할 때까지 반복하는 알고리즘이다. 함수의 기울기가 가장 낮은 곳에 도달한다면 최적의 해를 갖게 된다.</p>

\[W_0 = Initial \  Value \\
W_{i+1} = W_{i} + \alpha \nabla f(W_{i})\]

<p>경사 하강법을 포함한 최적화 함수들은 초기값(W_0)을 설정해 다음 가중치(W_1, W_2, …)를 찾는다.</p>
<ul>
  <li>$\nabla f(W_i)$는 앞의 기울기를 의미</li>
  <li>새로운 가중치는 기울기의 부호와 관계없이 기울기가 0인 방향으로 학습이 진행</li>
  <li>기울기가 0을 갖게 되는 가중치를 찾을 때까지 반복</li>
  <li>$\alpha$는 기울기가 한 번에 이동하는 <strong>간격(Step Size)</strong>을 조정</li>
</ul>

<h4 id="가중치-갱신-방법">가중치 갱신 방법</h4>

<p>가설과 손실 함수는 아래와 같다.</p>

\[\hat{Y_i} = W_i \times x + b_i \\
MSE(W, b) = \frac{1}{n}\sum_{i=1}^{n}(Y_i - \hat{Y_i})^2\]

<p>가중치를 갱신할 때 W에 대해 편미분을 진행한다.</p>

<p><img src="https://github.com/user-attachments/assets/4375681c-83cc-4111-8d11-2ad524e9c45b" /></p>

<p>가중치 갱신 방법을 일반화하면 다음과 같다.</p>

\[W_{i+1} = W_i + \alpha \times E[(\hat{Y_i} - Y_i) \times x]\]

<h3 id="학습률">학습률</h3>

<p>가중치를 갱신할 때 $\alpha$를 곱해 가중치 결과를 조정하는 것을 확인했다. 머신러닝에서는 $\alpha$ 값을 <strong>학습률(Learning Rate)</strong>이라고 한다. 초기값(W_0)을 임의의 값으로 설정해 주듯이 이 학습률($\alpha$)도 임의의 값으로 설정한다.</p>

<p>학습률에 따라 다음 가중치($W_{1}$, $W_{2}$, …)의 변화량이 결정되며, 이에 따라 최적의 해를 찾기 위한 반복 횟수가 결정된다. 만약 적절하지 않은 학습률을 선택하면 너무 많은 반복이 필요하거나, 아무리 반복을 시도해도 최적의 해를 찾기 어려울 수 있다.</p>

<p><img src="https://velog.velcdn.com/images/seungwoong12/post/15e4e46c-0726-4d24-957a-314648d46cc3/image.png" /></p>

<h3 id="최적화-문제">최적화 문제</h3>

<p>학습률을 너무 낮거나 높게 잡으면 최적의 가중치를 찾는 데 오랜 시간이 걸리거나, 그래프가 발산하여 아예 값을 찾지 못할 수 있다. 학습률을 낮게 잡고 많은 연산을 하더라도 최적의 가중치를 찾을 수 있는 것처럼 보이지만 찾지 못할 수도 있다.</p>

<p><img src="https://blog.kakaocdn.net/dn/cBDz4z/btrhqK7G8rZ/VIHRUsqwRgFB5waHSuOVU0/img.png" /></p>

<p>기울기가 0이 되는 지점은 극값은 <strong>최댓값(Global Maximum)</strong>, <strong>최솟값(Global Minimum)</strong>, <strong>극댓값(Local Maximum)</strong>, <strong>극솟값(Local Minimum)</strong>으로 구분할 수 있다. 초기 가중치나 학습률을 설정할 때 시작점이 적절하지 않거나 학습률이 너무 낮으면 최솟값이 아닌, 극솟값에서 가중치가 결정될 수 있다.</p>

<p>즉, 학습률을 너무 낮게 잡으면 극소 지점을 넘지 못해 지역적 최솟값으로 가중치가 결정된다. 또한 <strong>안장점(Saddle Point)</strong>이 존재하는 함수에서도 적절한 가중치를 찾을 수 없다.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/Saddle_point.svg/1200px-Saddle_point.svg.png" /></p>

<p>안장점은 특정 방향(아래에서 위로, 위에서 아래로)에서 바라볼 경우 최댓값(또는 극댓값)이 되지만, 다른 방향에서 보면 최솟값(또는 극솟값)이 되는 지점을 의미한다.</p>

<p>최적화 알고리즘은 경사 하강법처럼 목적 함수가 최적의 값을 찾아갈 수 있도록 최적화되게끔 하는 알고리즘이다. 어떤 최적화 알고리즘을 사용하느냐에 따라 모델의 정확도가 달라진다.</p>

<p>학습에 사용하는 데이터의 형태나 가설, 손실 함수 등에 따라 적합한 최적화 알고리즘을 사용해야 하며 앞의 극소 문제와 안장점 문제 등에 강건한 기법도 존재한다.</p>

<p>경사 하강법 이외에도 다양한 최적화 알고리즘이 있다.</p>

<p><img src="https://velog.velcdn.com/images/chang0517/post/f955570a-69fb-4c2a-9f19-f9c7264599ca/image.png" /></p>

<h3 id="단순-선형-회귀-넘파이">단순 선형 회귀: 넘파이</h3>

<p>넘파이를 활용해 지도 학습 중 하나인 단순 선형 회귀를 구현할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 데이터 선언(넘파이)
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span>
  <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span>
  <span class="p">[[</span><span class="mf">0.94</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.98</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.88</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.92</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.96</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.55</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.64</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.44</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.1</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">8.46</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.67</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.16</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.83</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.32</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">17.46</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.8</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mf">21.34</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">24.57</span><span class="p">],</span> <span class="p">[</span><span class="mf">26.04</span><span class="p">],</span> <span class="p">[</span><span class="mf">21.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">28.8</span><span class="p">]]</span>
<span class="p">)</span>

<span class="c1"># 하이퍼 파리미터 초기화
</span><span class="n">weight</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">bias</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.005</span>


<span class="c1"># 에폭 설정
</span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>

  <span class="c1"># 가설과 손실 함수 선언
</span>  <span class="n">y_hat</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">bias</span>
  <span class="n">cost</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_hat</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>

  <span class="c1"># 가중치와 편향 갱신(넘파이)
</span>  <span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="p">((</span><span class="n">y_hat</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_hat</span> <span class="o">-</span> <span class="n">y</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
  
  <span class="c1"># 학습 기록 출력
</span>  <span class="k">if</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Epoch: </span><span class="si">{</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="n">d</span><span class="si">}</span><span class="s">, Weight: </span><span class="si">{</span><span class="n">weight</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">, Bias : </span><span class="si">{</span><span class="n">bias</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">, Cost: </span><span class="si">{</span><span class="n">cost</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">weight</code>: 가중치($W_0$)</li>
  <li><code class="language-plaintext highlighter-rouge">bias</code>: 편향</li>
  <li><code class="language-plaintext highlighter-rouge">learning_rate</code>: 학습률</li>
  <li><code class="language-plaintext highlighter-rouge">epoch</code>: 에폭은 인공 신경망에서 순전파와 역전파 과정 등의 모델 연산을 전체 데이터세트가 1회 통과하는 것을 의미
    <ul>
      <li>각 에폭은 모델이 데이터를 학습하고 가중치를 갱신하는 단계를 나타내며, 여러 에폭을 반복해 모델을 학습</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>초기값에 따른 학습 결과<br />
  초기값의 설정은 학습에 큰 영향을 끼친다. 초기값을 할당했을 때 하이퍼파라미터 튜닝을 진행하며, 하이퍼파라미터 튜닝을 통해 원할한 학습을 진행할 수 있다.</p>
</blockquote>

<h3 id="단순-선형-회귀-파이토치">단순 선형 회귀: 파이토치</h3>

<p>넘파이가 아닌 파이토치를 이용해서 단순 선형 회귀를 구현할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 프레임워크 선언
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">optim</span> <span class="c1"># 최적화 함수가 포함돼 있는 모듈
</span>
<span class="c1"># 데이터 선언(파이토치)
</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">(</span>
  <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">(</span>
  <span class="p">[[</span><span class="mf">0.94</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.98</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.88</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.92</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.96</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.55</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.64</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.44</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.1</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">8.46</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.67</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.16</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.83</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.32</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">17.46</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.8</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mf">21.34</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">24.57</span><span class="p">],</span> <span class="p">[</span><span class="mf">26.04</span><span class="p">],</span> <span class="p">[</span><span class="mf">21.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">28.8</span><span class="p">]]</span>
<span class="p">)</span>

<span class="c1"># 하이퍼파라미터 초기화
</span><span class="n">weight</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zero</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zero</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="c1"># 최적화 선언
</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="p">.</span><span class="n">SGD</span><span class="p">([</span><span class="n">weight</span><span class="p">,</span> <span class="n">bias</span><span class="p">],</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>

<span class="c1"># 에폭, 가설, 손실 함수 선언
</span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">weight</span> <span class="o">+</span> <span class="n">bias</span>
  <span class="n">cost</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">mean</span><span class="p">((</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

  <span class="c1"># 가중치와 편향 갱신
</span>  <span class="n">optimizer</span><span class="p">.</span><span class="n">zero_grad</span><span class="p">()</span>
  <span class="n">cost</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>   
  <span class="n">optimizer</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Epoch : </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="n">d</span><span class="si">}</span><span class="s">, Weight: </span><span class="si">{</span><span class="n">weight</span><span class="p">.</span><span class="n">item</span><span class="p">():.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">, Bias : </span><span class="si">{</span><span class="n">bias</span><span class="p">.</span><span class="n">item</span><span class="p">():.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">, Cost : </span><span class="si">{</span><span class="n">cost</span><span class="p">.:</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">requires_grad</code>: 모든 텐서에 대한 연산을 추적하며 역전파 메서드를 호출해 기울기를 계산하고 저장
    <ul>
      <li>파이토치에서 지원하는 <strong>자동 미분(Autograd)</strong> 기능의 사용 여부</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">optim.SGD()</code>: 확률적 경사 하강법으로 일부 데이터만 계산하여 빠르게 최적화된 값을 찾는 방식
    <ul>
      <li>변수(<code class="language-plaintext highlighter-rouge">params</code>)와 학습률(<code class="language-plaintext highlighter-rouge">lr</code>)로 최적화를 적용
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span>
<span class="n">params</span><span class="p">,</span>
<span class="n">lr</span><span class="p">,</span>
<span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h4 id="zero_grad-costbackward-optimizerstep">zero_grad(), cost.backward(), optimizer.step()</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">zero_grad()</code>: 파라미터 초기화</li>
  <li><code class="language-plaintext highlighter-rouge">cost.backward()</code>: 역전파 계산</li>
  <li><code class="language-plaintext highlighter-rouge">optimizer.step()</code>: 확률적 경사 하강법을 수행한 결과를 파라미터에 반영</li>
</ul>

<h3 id="신경망-패키지">신경망 패키지</h3>

<p>신경망 패키지는 <code class="language-plaintext highlighter-rouge">torch.nn</code>에 포함돼 있으며 <code class="language-plaintext highlighter-rouge">from torch import nn</code>의 형태로 선언한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 선형 변환 클래스
</span><span class="n">layer</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span>
  <span class="n">in_features</span><span class="p">,</span>
  <span class="n">out_features</span><span class="p">,</span>
  <span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
  <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
  <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span>
<span class="p">)</span>
</code></pre></div></div>

<p>선형 변환 클래스는 $y = Wx + b$ 형태의 선형 변환을 입력 데이터에 적용한다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">in_features</code>: 입력 차원 크기</li>
  <li><code class="language-plaintext highlighter-rouge">out_features</code>: 출력 데이터 차원 크기</li>
  <li><code class="language-plaintext highlighter-rouge">bias</code>: 계층에 편향 값 포함 여부</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 모델 선언
</span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">MSELoss</span><span class="p">()</span>  <span class="c1"># 평균 제곱 오차 계산
</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="c1"># 순방향 연산
</span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">moddel</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">cost</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span> <span class="p">,</span><span class="n">y</span><span class="p">)</span>

  <span class="n">optimizer</span><span class="p">.</span><span class="n">zerop_grad</span><span class="p">()</span>
  <span class="n">cost</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
  <span class="n">optimizer</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>
</code></pre></div></div>


        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#pytorch" class="page__taxonomy-item" rel="tag">Pytorch</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-04-28">April 28, 2025</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/pytorch/installation/" class="pagination--pager" title="파이토치 설치
">Prev</a>
    
    
      <a href="/nlp/embedding-1/" class="pagination--pager" title="임베딩(1)
">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/nlp/rnn/" rel="permalink">순환 신경망
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2025-04-17T00:00:00+09:00">April 17, 2025</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">RNN / LSTM
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/nlp/cnn/" rel="permalink">합성곱 신경망
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2025-04-16T00:00:00+09:00">April 16, 2025</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">CNN / 완전 연결 계층 / 1차원 합성곱 &amp; 자연어 처리
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/nlp/embedding-2/" rel="permalink">임베딩(2)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2025-04-05T00:00:00+09:00">April 5, 2025</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Word2Vec / fastText
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/aws_saa/intro/" rel="permalink">AWS Cloud Introduction
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2025-04-05T00:00:00+09:00">April 5, 2025</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">AWS
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Seojin. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
