<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="파이토치 심화(2)" />
<meta property="og:locale" content="en" />
<meta name="description" content="정칙화 / 데이터 증강 및 변환" />
<meta property="og:description" content="정칙화 / 데이터 증강 및 변환" />
<link rel="canonical" href="http://localhost:4000/pytorch-book/pytorch/advance-2/" />
<meta property="og:url" content="http://localhost:4000/pytorch-book/pytorch/advance-2/" />
<meta property="og:site_name" content="Seojin Devlog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-06-21T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="파이토치 심화(2)" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="google-site-verification" content="WfkV1-iar8_v-Mbi-ytl5RBJhiNOfpUEWrLuOCyThLQ" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-25T00:00:00+09:00","datePublished":"2025-06-21T00:00:00+09:00","description":"정칙화 / 데이터 증강 및 변환","headline":"파이토치 심화(2)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/pytorch-book/pytorch/advance-2/"},"url":"http://localhost:4000/pytorch-book/pytorch/advance-2/"}</script>
<!-- End Jekyll SEO tag -->


  <title>파이토치 심화(2) | Seojin Devlog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Seojin Devlog">
<meta name="application-name" content="Seojin Devlog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Seojin Devlog</a>
    <p class="site-subtitle fst-italic mb-0">AI 기술을 배우고 코드로 기록하는 학생 개발자입니다</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/Parkseojin2001"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['seojin0510612','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/seojin-park-793a15287/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
        
          
            
              <span>파이토치 심화(2)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>파이토치 심화(2)</h1>
    
      <p class="post-desc fw-light mb-4">정칙화 / 데이터 증강 및 변환</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1750431600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jun 21, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1750809600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jun 25, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">Seojin Park</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="14393 words"
>
  <em>79 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">파이토치 심화(2)</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">파이토치 심화(2)</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="정칙화"><span class="me-2">정칙화</span><a href="#정칙화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<p><strong>정칙화(Regularization)</strong>란 모델 학습 시 발생하는 과대적합 문제를 방지하기 위해 사용되는 기술로, 모델이 <strong>암기(Memorization)</strong>가 아니라 <strong>일반화(Generalization)</strong>할 수 있도록 손실 함수에 <strong>규제(Penalty)</strong>를 가하는 방식이다.</p>

<ul>
  <li>암기: 모델이 데이터의 특성이나 패턴을 학습하는 것이 아니라 훈련 데이터의 노이즈를 학습했을 때 발생
    <ul>
      <li>모델이 훈련 데이터에서는 잘 수행되지만, 새로운 데이터에서는 재대로 수행되지 못한다.</li>
      <li>데이터의 일반적인 패턴을 학습한 것이 아니라 학습 데이터의 노이즈나 특정 패턴을 학습</li>
    </ul>
  </li>
  <li>일반화: 모델이 새로운 데이터에서도 정확한 예측을 할 스 있음을 의미
    <ul>
      <li>특정 데이터가 갖고 있는 노이즈가 아닌 데이터의 일반적인 패턴을 학습했을 때 일반화된 모델이라 부름</li>
      <li>일반화된 모델은 학습에 사용한 데이터와 약간 다르더라도 정확한 예측을 할 수 있음</li>
    </ul>
  </li>
  <li>정칙화: 노이즈에 강건하고 일반화된 모델을 구축하기 위해 사용하는 방법
    <ul>
      <li>모델이 특정 피처나 특정 패턴에 너무 많은 비중을 할당하지 않도록 손실 함수에 규제를 가해 모델의 <strong>일반화 성능(Generalization Performance)</strong>을 향상시킴</li>
      <li>적용을 하면 학습 데이터들이 갖고 있는 작은 차이점에 대해 덜 민감해져 모델의 분산 값이 낮아져 모델이 의존하는 특징 수를 줄임으로써 모델의 추론 능력을 개선</li>
    </ul>
  </li>
</ul>

<p><a href="https://blog.kakaocdn.net/dn/bumg11/btsqLlyJM7b/bOQ5SYMg8WHB8RhtYZbOz0/img.png" class="popup img-link shimmer"><img src="https://blog.kakaocdn.net/dn/bumg11/btsqLlyJM7b/bOQ5SYMg8WHB8RhtYZbOz0/img.png" loading="lazy"></a></p>

<p>정칙화는 모델이 비교적 복잡하고 학습에 사용되는 데이터의 수가 적을 때 활용한다. 노이즈에 강건하게 만드므로 이미 정규화되어 있는 경우에는 사용하지 않아도 된다.</p>

<h3 id="l1-정칙화"><span class="me-2">L1 정칙화</span><a href="#l1-정칙화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>L1 정칙화(L1 Regularization)</strong>는 <strong>라쏘 정칙화(Lasso Regularization)</strong>라고도 하며, <strong>L1 노름(L1 Norm)</strong> 방식을 사용해 규제하는 방법이다.</p>

<blockquote>
  <p>L1 노름은 벡터 또는 행렬값의 절댓값 합계를 계산한다.</p>
</blockquote>

<p>이러한 방식을 차용해 L1 정칙화는 손실 함수에 가중치 절댓값의 합을 추가해 과대적합을 방지한다.</p>

<ul>
  <li>모델 학습은 비용이 0이 되는 방향으로 진행하며 손실 함수에 가중치 절댓값을 추가하므로 이 값도 최소화 하는 방향으로 학습이 진행된다.</li>
  <li>모델 학습 시 값이 크지 않은 가중치들은 0으로 수렴하게 되어 예측에 필요한 특징의 수가 줄어든다.</li>
  <li>불필요한 가중치가 0으로 수렴하게 되어 예측에 필요한 특징의 수가 줄어들어 특징 선택 효과를 얻을 수 있다.</li>
</ul>

\[L_1 = \lambda * \sum_{i=0}^{n}|w_i|\]

<ul>
  <li>$\lambda$: 규제 강도로, 너무 많거나 적은 규제를 가하지 않게 조절하는 하이퍼파라미터로 0보다 큰 값으로 설정
    <ul>
      <li>0에 가까워질수록 더 많은 특징을 사용하기 때문에 과대적합에 민감해진다.</li>
      <li>규제 강도를 높이면 대부분의 가중치가 0에 수렴되기 때문에 과소적합 문제가 발생</li>
    </ul>
  </li>
</ul>

<p>L1 정칙화를 적용하는 경우 입력 데이터에 더 민감해지며, 항상 최적의 규제를 가하지 않으므로 사용에 주의해야한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1"># L1 정칙화 적용
</span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">train_dataloader</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">_lambda</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">l1_loss</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="nf">abs</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="p">.</span><span class="nf">parameters</span><span class="p">())</span>

    <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">_lambda</span> <span class="o">*</span> <span class="n">l1_loss</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>모델의 가중치를 모두 계산해 모델을 갱신해야 하므로 <strong>계산 복잡도</strong>를 높이게 된다.</li>
  <li>L1 정칙화는 미분이 불가능해 역전파를 계산하는 데 더 많은 리소스를 소모</li>
  <li>하이퍼파라미터인 <code class="language-plaintext highlighter-rouge">_lambda</code>의 값이 적절하지 않으면 가중치 값들이 너무 작아져 모델을 해것하기 더 어렵게 만듦</li>
</ul>

<p>L1 정칙화는 주로 선형 모델에 적용하며 이를 <strong>라쏘 회귀</strong>라 한다.ㄴ</p>

<h3 id="l2-정칙화"><span class="me-2">L2 정칙화</span><a href="#l2-정칙화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>L2 정칙화(L2 Regularization)</strong>는 <strong>릿지 정칙화(Ridge Regularization)</strong>라고도 하며 <strong>L2 노름(L2 Norm)</strong> 방식을 사용해 규제하는 방법이다.</p>

<blockquote>
  <p>L2 노름은 벡터 또는 행렬 값의 크기를 계산한다.</p>
</blockquote>

<p>이 방식을 차용해 L2 정칙화는 손실 함수에 가중치 제곱의 합을 추가해 과대적합을 방지하도록 규제한다.</p>

<ul>
  <li>하나의 특징이 너무 중요한 요소가 되지 않도록 규제를 가함</li>
  <li>모델 학습 시 오차를 최소화하면서 가중치를 작게 유지하고 골고루 분포되게끔 하므로 모델의 복잡도가 일부 조정</li>
  <li>L2 정칙화는 가중치 값들이 비교적 균일하게 분포되며, 가중치를 0으로 만들지 않고 0에 가깝게 만듦</li>
</ul>

\[L_2 = \lambda * \sum_{i=0}^n|w_i^2|\]

<p>L1 정칙화와 L2 정칙화에 평균 제곱 오차를 적용했을 떄 $y=w \times x$의 결과를 통해 둘의 관계를 알 수 있다. 이떄 가중치($w=0.5$)로 설정한다.</p>

<p><a href="/../assets/img/post/pytorch-book/L1_L2_before.png" class="popup img-link shimmer"><img src="/../assets/img/post/pytorch-book/L1_L2_before.png" width="486" height="420" loading="lazy"></a></p>

<p>모델은 $y = 0.5x$ 이므로 평균 제곱 오차의 손실이 가장 낮은 가중치 값은 0.5가 된다.</p>
<ul>
  <li>L1 정칙화는 가중치 절댓값으로 계산되므로 선형적인 구조를 갖는다.</li>
  <li>L2 정칙화는 가중치 제곱으로 계산되므로 비선형적인 구조를 갖는다.</li>
</ul>

<p>정칙화는 손실 함수에 규제 값을 더해주는 방법으로 적용되며 이를 적용하면 아래의 그래프처럼 그려진다.</p>

<p><a href="/../assets/img/post/pytorch-book/L1_L2_after.png" class="popup img-link shimmer"><img src="/../assets/img/post/pytorch-book/L1_L2_after.png" width="486" height="420" loading="lazy"></a></p>

<p>L1 정칙화는 선형적인 특성을 가져 가중치가 0이 아닌 곳에서는 모든 값에 고정적인 값을 추가하는 반면에 L2 정칙화는 비선형적인 특성을 가지므로 가중치가 0에 가까워질수록 규젯값이 줄어든다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1"># L2 정칙화 적용
</span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">train_dataloader</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">_lambda</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">ls_loss</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="nf">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="p">.</span><span class="nf">parameters</span><span class="p">())</span>

    <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">_lambda</span> <span class="o">*</span> <span class="n">l2_loss</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>L2 정칙화는 모델 매개변수의 제곱 값을 계산하고 저장해야 하므로 L1 보다 많은 리소스를 소모</li>
  <li>하이퍼파라미터인 <code class="language-plaintext highlighter-rouge">_lambda</code>도 여러 번 반복해 최적의 <code class="language-plaintext highlighter-rouge">_lambda</code> 값을 찾아야 함</li>
</ul>

<p>과대적합을 효과적으로 방지하기 위해선느 조기 중지 또는 드롭아웃과 같은 기술과 함께 사용한다. L2 정칙화는 주로 심층 신경망 모델에서 사용하며, 선형 회귀 모델에서 L2 정칙화를 적용하는 경우를 <strong>릿지 회귀(Ridge Regression)</strong>라고 한다.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th> </th>
      <th>L1 정칙화</th>
      <th>L2 정칙화</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>계산 방식</td>
      <td>가중치 절댓값의 합</td>
      <td>가중치 제곱의 합</td>
    </tr>
    <tr>
      <td>모델링</td>
      <td>희소함(Sparse Solution)</td>
      <td>희소하지 않음(Non-sparse Solution)</td>
    </tr>
    <tr>
      <td>특징 선택</td>
      <td>있음</td>
      <td>없음</td>
    </tr>
    <tr>
      <td>이상치</td>
      <td>강함</td>
      <td>약함</td>
    </tr>
    <tr>
      <td>가중치</td>
      <td>0이 될 수 있음</td>
      <td>0에 가깝게 됨</td>
    </tr>
    <tr>
      <td>학습</td>
      <td>비교적 복잡한 데이터 패턴을 학습할 수 없음</td>
      <td>비교적 복잡한 데이터 패턴을 학습할 수 있음</td>
    </tr>
  </tbody>
</table></div>

<h3 id="가중치-감쇠"><span class="me-2">가중치 감쇠</span><a href="#가중치-감쇠" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>가중치 감쇠(Weight Decay)</strong>는 모델이 더 작은 가중치를 갖도록 손실 함수에 규제를 가하는 방법이다. 파이토치나 텐서플로와 같은 딥러닝 라이브러리에서는 이 용어가 최적화 함수에 적용하는 L2 정규화 의미로 사용된다.</p>

<p>파이토치의 가중치 감쇠는 L2 정규화와 동일하며 최적화 함수에서 <code class="language-plaintext highlighter-rouge">weight_decay</code>하이퍼파라미터를 설정해 구현할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># 가중치 감쇠 적용
</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="nc">SGD</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>L2 정칙화를 간단하게 적용하는 방법으로 L2 정칙화의 장점과 단점을 모두 갖고있다.</li>
  <li>가중치 감쇠 하이퍼파라미터를 조정해 사용하고, 조기 중지 또는 드롭아웃과 같은 기술과 함께 사용한다.</li>
</ul>

<h3 id="모멘텀"><span class="me-2">모멘텀</span><a href="#모멘텀" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>모멘텀(Momentum)</strong>은 경사 하강법 알고리즘의 변형 중 하나로, 이전에 이동했던 방향과 기울기의 크기를 고려하여 가중치를 갱신한다.</p>

<ul>
  <li>지수 가중 이동평균을 사용하며, 이전 기울기 값의 일부를 현재 기울기 값에 추가해 가중치를 갱신한다.</li>
  <li>이전 기울기 값에 의해 설정된 방향으로 더 빠르게 이동하므로, 일종의 관성(Momentum) 효과를 얻을 수 있다.</li>
</ul>

\[\begin{align*}
v_i &amp;= \gamma v_{i-1} + \alpha \nabla f(W_i) \\
W_{i+1} &amp;= W_i - v_i
\end{align*}\]

<ul>
  <li>$\gamma$ : 모멘텀 계수로 0.0~1.0 사이의 값으로 설정할 수 있으며 일반적으로 0.9와 같은 값을 사용</li>
  <li>$v_i$ : $i$번째 모멘텀 값으로, 이동 벡터를 의미하며 이전 모멘텀 값 $v_{i-1}$에 모멘텀 계수를 곱한 값과 경사 하강법의 갱신 값의 합으로 계산</li>
</ul>

<h3 id="엘라스틱-넷"><span class="me-2">엘라스틱 넷</span><a href="#엘라스틱-넷" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>엘라스틱 넷(Elastic-Net)</strong>은 L1 정칙화와 L2 정칙화를 결합해 사용하는 방식이다. L1 정칙화는 모델이 희박한 가중치를 갖게 규제하는 반면, L2 정칙화는 큰 가중치를 갖지 않게 규제한다. 이 두 정칙화 방식을 결합함으로써 희소성과 작은 가중치의 균형을 맞춘다.</p>

\[Elastic - Net = \alpha \times L_1 + (1 - \alpha) \times L_2\]

<ul>
  <li>엘라스틱 넷은 L1, L2 정칙화보다 트레이드오프 문제를 더 유연하게 대처할 수 있다.
    <blockquote>
      <p>트레이드오프: 이상적인 모델은 편향과 분산을 모두 낮춰서 전체 오류(Error)를 최소화하는 지점을 찾는 것으로 이 최적의 균형점을 찾는 것을 말한다.</p>
    </blockquote>
  </li>
  <li>엘라스틱 넷은 특징의 수가 샘플의 수보다 더 많을 때 유의미한 결과를 가져올 수 있으므로 상관관계가 있는 특징을 더 잘 처리할 수 있다.</li>
  <li>각 정칙화가 가진 장저을 최대한 활용할 수 있는 반면에 균형적인 규제를 가하기 위해 혼합 비율도 조정해야하므로 더 많은 튜닝과 리소스가 필요하다.</li>
</ul>

<h3 id="드롭아웃"><span class="me-2">드롭아웃</span><a href="#드롭아웃" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>드롭아웃(Dropout)</strong>은 정칙화 기법 중 하나로, 모델의 훈련 과정에서 일부 노드를 일정 비율로 제거하거나 0으로 설정해 과대적합을 방지하는 간단하고 효율적인 방법이다.</p>

<p>과대적합을 발생시키는 이유 중 하나는 모델 학습 시 발생하는 노드 간 <strong>동조화(Co-adaptation)</strong> 현상이다.</p>

<blockquote>
  <p>동조화 현상: 모델 학습 중 특정 노드의 가중치나 편향이 큰 값을 갖게 되면 다른 노드가 큰 값을 갖는 노드에 의존하는 것을 말한다.</p>
</blockquote>

<p>이러한 현상은 특정 노드에 의존성이 생겨 학습 속도가 느려지고 새로운 데이터를 예측하지 못해 성능을 저하시킬 수 있다. 그러므로 학습 과정에서 일부 노드를 제거해 노드 간 의존성을 억제해야 한다.</p>

<p><a href="https://www.oreilly.com/api/v2/epubs/9781788295628/files/assets/d4d20bd7-192c-48e7-9da2-6d3ddc7929e7.png" class="popup img-link shimmer"><img src="https://www.oreilly.com/api/v2/epubs/9781788295628/files/assets/d4d20bd7-192c-48e7-9da2-6d3ddc7929e7.png" loading="lazy"></a></p>

<ul>
  <li>모델이 일부 노드를 제거해 학습하므로 <strong>투표(Voting)</strong> 효과를 얻을 수 있어 <strong>모델 평균화(Model Averaging)</strong>가 된다.</li>
  <li>모델 평균화 효과를 얻기 위해 다른 드롭아웃 마스크를 사용해 모델을 여러 번 훈련해야 하므로 훈련 시간이 늘어난다.</li>
  <li>모든 노드를 사용해 학습하지 않으므로 데이터세트가 많지 않다면 효과를 얻기 힘들며, 충분한 데이터세트와 학습이 없다면 모든 노드가 균일하게 학습될 수 없으므로 성능이 저하될 수 있다.</li>
</ul>

<p>드롭아웃을 적용할 때는 충분히 데이터세트와 비교적 깊은 모델에 적용한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c1"># 드롭아웃 적용
</span><span class="kn">from</span> <span class="n">torch</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">layer2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></td></tr></tbody></table></code></div></div>

<p>드롭아웃은 신경망 패키지에 있는 <code class="language-plaintext highlighter-rouge">Dropout</code> 클래스로 쉽게 구현할 수 있다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">p</code>: 베르누이 분포의 모수를 의미하며, 이 분포로 각 노드의 제거 여부를 확률적으로 선택한다.</li>
  <li>순방향 메서드에서 드롭아웃을 적용할 계층 노드에 적용된다.</li>
  <li>훈련 과정에서만 사용하며 추론하는 과정에서는 모든 노드를 사용해 예측한다.</li>
</ul>

<p>드롭아웃은 일반적으로 배치 정규화와 동시에 사용하지 않으므로 다른 기법을 동시에 적용할 때 주의해서 적용한다.</p>

<ul>
  <li>배치 정규화의 경우 내부 공변량 변화를 줄여 과대적합을 방지하는데, 드롭아웃은 일부 노드를 제거하는데 이 두 가지 방법을 동시에 사용하면 서로 다른 활성화 분포를 사용해 훈련 과정에서 성능이 저하되거나 불안정해진다.</li>
  <li>드롭아웃과 배치 정규화를 사용하는 경우에는 드롭아웃, 배치 정규화 순으로 적용한다.</li>
</ul>

<p>드롭아웃은 극단적인 비율로 모델에 적용하지 않는다면 일반적으로 성능 향상의 이점을 얻을 수 있으며 비교적 많은 특징을 사용해 학습하는 이미지 인식이나 음성 인식 모델에서 성능이 향상되는 결과를 보였다.</p>

<h3 id="그레이디언트-클리핑"><span class="me-2">그레이디언트 클리핑</span><a href="#그레이디언트-클리핑" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>그레이디언트 클리핑(Gradient Clipping)</strong>은 모델을 학습할 때 기울기가 너무 커지는 현상을 방지하는 데 사용되는 기술이다. 과대적합 모델은 특정 노드의 가중치가 너무 크다는 특징을 갖는다. 높은 가중치는 높은 분산 값을 갖게 하여 모델의 성능이 저하될 수 있다.</p>

<p>이러한 현상을 방지하기 위해 가중치 최댓값을 규제해 최대 임곗값을 초과하지 않도록 기울기를 잘라(Clipping) 설정한 임곗값으로 변경한다.</p>

\[\begin{align*}
w = r \frac{w}{||w||} \ \ \text{if:} ||w|| &gt; r
\end{align*}\]

<ul>
  <li>그레이디언트 클리핑은 가중치 노름이 최대 임곗값 $r$보다 높은 경우에 수행된다.</li>
  <li>최대 임곗값을 넘는 경우 기울기 벡터의 방향을 유지하면서 기울기를 잘라 규제할 수 있으며 일반적으로 L2 노름을 사용해 최대 기울기를 규제한다.</li>
  <li>최대 임곗값 $r$은 하이퍼파라미터로 사용자가 최대 임곗값을 설정해야 한다. 0.1이나 1과 같이 작은 크기의 임곗값을 적용하며 학습률을 조절하는 것과 비슷한 효과를 얻을 수 있다.</li>
</ul>

<p>그레이디언트 클래핑은 순환 신경망(RNN)이나 LSTM 모델을 학습하는 데 주로 사용된다. 두 모델은 기울기 폭주에 취약한데, 그레이디언트 클리핑은 최댓값을 억제하므로 많이 활용된다. 또한, 가중치 값에 대한 엄격한 제약 조건을 요구하는 상황이거나 모델이 큰 기울기에 민감한 상황에서 유용하게 활용할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># 그레이디언트 클리핑 함수
</span><span class="n">grad_norm</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="nf">clip_grad_norm_</span><span class="p">(</span>
    <span class="n">parameters</span><span class="p">,</span>
    <span class="n">max_norm</span><span class="p">,</span>
    <span class="n">norm_type</span><span class="o">=</span><span class="mf">2.0</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">parameters</code>: 기울기를 정규화하려는 매개변수</li>
  <li><code class="language-plaintext highlighter-rouge">max_norm</code>: 기울기를 잘라내는 기준(초과하는 경우 잘라냄)</li>
  <li><code class="language-plaintext highlighter-rouge">norm_type</code>: 클리핑을 계산할 노름 유형으로 무한대 노름을 적용한다면 <code class="language-plaintext highlighter-rouge">flot('inf')</code>로 설정 가능</li>
</ul>

<p>그레이디언트 클리핑 함수는 매개변수 기울기의 <strong>전체 노름 단일 벡터(<code class="language-plaintext highlighter-rouge">grad_norm</code>)</strong>를 반환하며, 정규화된 기울기는 반환하지 않고 매개변수를 직접 수정한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1"># 그레이디언트 클리핑 적용
</span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">train_dataloader</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>

    <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="nf">clip_grad_norm_</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="p">.</span><span class="nf">step</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>그레이디언트 클리핑 함수는 역전파(<code class="language-plaintext highlighter-rouge">loss.backward</code>)를 수행한 이후와 최적화 함수(<code class="language-plaintext highlighter-rouge">optimizer.step</code>)를 반영하기 전에 호출한다.</li>
  <li>임곗값을 초과하는 경우 기울기를 임곗값으로 자름</li>
</ul>

<p>그레이디언트 클리핑은 기울기 최댓값을 규제해 비교적 큰 학습률을 사용할 수 있게 해주지만, 최대 임곗값이 높으면 모델의 표현력이 떨어지며, 낮은 경우 오히려 학습이 불안정해질 수 있다.
그러므로 여러 번 실험을 통해 경험적으로 신중히 선택해야 한다.</p>

<h2 id="데이터-증강-및-변환"><span class="me-2">데이터 증강 및 변환</span><a href="#데이터-증강-및-변환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<p><strong>데이터 증강(Data Augmentation)</strong>이란 데이터가 가진 고유한 특징을 유지한 채 변형하거나 노이즈를 추가해 데이터세트의 크기를 인위적으로 늘리는 방법이다.</p>

<p>강건한 모델을 구축하기 위한 가장 중요한 요소는 학습 데이터의 수와 품질이지만 데이터 수집이 어려운 경우에는 기존 학습 데이터를 재가공해 원래 데이터와 유사하지만 새로운 데이터를 생성할 수 있다.</p>

<p><strong>데이터 증강 장점</strong><br /></p>
<ul>
  <li>데이터 증강은 모델의 과대적합을 줄일고 일반화 능력을 향상시킬 수 있다.</li>
  <li>기존 데이터 품질을 유지한 채 특징을 살려 모델 학습에 사용할 수 있다.</li>
  <li>데이터 세트를 인위적으로 늘리면 기존 데이터의 형질이 유지되므로 모델의 분산과 편향을 줄일 수 있다.</li>
  <li>데이터 수집 시 잘못된 정보가 들어오는 문제가 발생하지 않는다.</li>
  <li>특정 클래스의 데이터 수가 적은 경우 데이터 증강을 통해 데이터 불균형을 완화할 수 있다.</li>
</ul>

<p><strong>데이터 증강 단점</strong><br /></p>
<ul>
  <li>기존 데이터를 변형하거나 노이즈를 추가하므로 너무 많은 변형이나 노이즈를 추가한다면 기존 데이터가 가진 특징이 파괴될 수 있어 데이터의 일관성이 사라질 수 있다.</li>
  <li>특정 알고리즘을 적용해 생성하므로 데이터 수집보다 더 많은 비용이 들 수 있다.</li>
</ul>

<h3 id="텍스트-데이터"><span class="me-2">텍스트 데이터</span><a href="#텍스트-데이터" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>텍스트 데이터 증강은 자연어 처리 모델을 구성할 때 데이터세트의 크기를 쉽게 늘리기 위해 사용된다. 텍스트 데이터 증강 방법은 크기 삽입, 삭제, 교체, 대체, 생성, 반의어, 맞춤법 교정, 역번역 등이 있다.</p>

<p><strong>자연어 처리 데이터 증강(NLPAUG) 라이브러리</strong>를 활용해 텍스트 데이터를 증강한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># 자연어 처리 데이터 증강 라이브러리 설치
</span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">requests</span> <span class="n">nlpaug</span> <span class="n">transformers</span> <span class="n">sacremoses</span> <span class="n">nltk</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="삽입-및-삭제"><span class="me-2">삽입 및 삭제</span><a href="#삽입-및-삭제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>삽입은 의미 없는 문자나 단어, 또는 문장 의미에 영향을 끼치지 않는 수식어 등을 추가하는 방법으로 임의의 단어나 문자를 기존 텍스트에 덧붙여 사용한다.</li>
  <li>삭제는 삽입과 반대로 임의의 단어나 문자를 삭제해 데이터의 특징을 유지하는 방법이다.</li>
</ul>

<p>삽입과 삭제는 문장의 의미는 유지한 채 시퀀스를 변경하므로 간단하고 강력한 증강 기법이지만, 너무 적은 양을 삽입하거나 삭제한다면 오히려 과대적합 문제를 발생시킬 수 있고 너무 많은 양을 삽입하거나 삭제한다면 데이터 품질 저하로 이어질 수 있다.</p>

<p><code class="language-plaintext highlighter-rouge">ContextualWordEmbsAug</code> 클래스는 BERT 모델을 활용해 단어를 삽입하는 기능을 제공하며 현재 문장 상황에 맞는 단어를 찾아 문장에 삽입해 반환한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1"># 단어 삽입
</span><span class="kn">import</span> <span class="n">nlpaug.augmenter.word</span> <span class="k">as</span> <span class="n">naw</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Those who can imagine anything, ca create the impossible.</span><span class="sh">"</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="p">.</span><span class="nc">ContextualWordEmbsAug</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="sh">"</span><span class="s">bert-base-uncased</span><span class="sh">"</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="sh">"</span><span class="s">insert</span><span class="sh">"</span><span class="p">)</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">aug</span><span class="p">.</span><span class="nf">augment</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>    <span class="c1"># 리스트 구조로 반환
</span>
<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">augmented</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">augmented_texts</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">src : </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">dst : </span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 출력 결과
# src : Those who can imagine anything, can create the impossible.
# dst : those scientists who can simply imagine seemingly anything, can create precisely the impossible.
</span></pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">model_path</code>는 <code class="language-plaintext highlighter-rouge">bert-base-uncased</code>나 <code class="language-plaintext highlighter-rouge">distilbert-base-uncased</code>를 인수로 활용해 적용하며 허깅 페이스에서 모델을 자동으로 다운로드해 불러온다.</li>
  <li><code class="language-plaintext highlighter-rouge">action</code>은 모델이 수행할 기능을 선택한다.
    <ul>
      <li>문장을 삽입하는 경우에는 <code class="language-plaintext highlighter-rouge">insert</code>를 적용한다.</li>
      <li><code class="language-plaintext highlighter-rouge">substitute</code>라는 단어를 대체하는 기능도 제공한다.</li>
    </ul>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">RandomCharAug</code> 클래스를 통해 무작위로 문자를 삭제할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1"># 문자 삭제 적용
</span><span class="kn">import</span> <span class="n">nlpaug.augmenter.char</span> <span class="k">as</span> <span class="n">nac</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Those who can imagine anything, ca create the impossible.</span><span class="sh">"</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">aug</span> <span class="o">=</span> <span class="n">nac</span><span class="p">.</span><span class="nc">RandomCharAug</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="sh">"</span><span class="s">delete</span><span class="sh">"</span><span class="p">)</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">aug</span><span class="p">.</span><span class="nf">augment</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">augmented</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">augmented_texts</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">src : </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">dst : </span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 출력 결과
# src : Those who can imagine anything, can create the impossible.
# dst: hos who can mgie anything, can rate the mossibl.
</span></pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>문장 내 단어들이 무작위로 삭제된다.</li>
  <li><code class="language-plaintext highlighter-rouge">RandomCharAug</code> 클래스는 삽입(<code class="language-plaintext highlighter-rouge">insert</code>), 대체(<code class="language-plaintext highlighter-rouge">substitute</code>), 교체(<code class="language-plaintext highlighter-rouge">swap</code>), 삭제(<code class="language-plaintext highlighter-rouge">delete</code>) 기능을 제공한다.</li>
</ul>

<h4 id="교체-및-대체"><span class="me-2">교체 및 대체</span><a href="#교체-및-대체" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>교체는 단어나 문자의 위치를 교환하는 방법이다.
    <ul>
      <li>본래의 의미나 맥락을 보존하지 못하게 되어 무의미하거나 의미상 잘못된 문장을 생성할 수 있으므로 데이터의 특성에 따라 주의해 사용해야 한다.</li>
    </ul>
  </li>
  <li>대체는 단어나 문자를 임의의 단어나 문자로 바꾸거나 동의어로 변경하는 방법을 의미한다.
    <ul>
      <li>단어나 문장을 대체하면 다른 증강 방법보다 비교적 데이터의 정합성이 어긋나지 않아 효율적으로 데이터를 증강할 수 있다.</li>
      <li>의미가 달라지거나 조사가 어색해질 수도 있다.</li>
    </ul>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">RandomWordAug</code> 클래스를 사용해 단어를 교체할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1"># 단어 교체
</span><span class="kn">import</span> <span class="n">nlpaug.augmenter.word</span> <span class="k">as</span> <span class="n">naw</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Those who can imagine anything, can create the impossible.</span><span class="sh">"</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="p">.</span><span class="nc">RandomWordAug</span><span class="p">(</span><span class="n">actino</span><span class="o">=</span><span class="sh">"</span><span class="s">swap</span><span class="sh">"</span><span class="p">)</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">aug</span><span class="p">.</span><span class="nf">augment</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">augmented</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">augmented_texts</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">src : </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">dst : </span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 출력 결과
# src : Those who can imagine anything, can create the impossible.
# dst : Those who can imagine can anything create, the. impossible
</span></pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">RandomWordAug</code> 클래스는 삽입(<code class="language-plaintext highlighter-rouge">insert</code>), 대체(<code class="language-plaintext highlighter-rouge">substitute</code>), 교체(<code class="language-plaintext highlighter-rouge">swap</code>), 삭제(<code class="language-plaintext highlighter-rouge">delete</code>), 자르기(<code class="language-plaintext highlighter-rouge">crop</code>) 기능도 지원한다.
    <ul>
      <li>자르기란 연속된 단어 집합을 한 번에 삭제하는 기능을 의미한다.</li>
    </ul>
  </li>
</ul>

<p>무작위 교체의 경우 문맥을 파악하지 않고 교체하여 출력 결과의 <code class="language-plaintext highlighter-rouge">the.</code> 와 같이 교체될 수 있으므로 사용에 주의해야한다.</p>

<p><code class="language-plaintext highlighter-rouge">SynonymAug</code> 클래스를 사용해 단어를 대체할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1"># 단어 대체
</span><span class="kn">import</span> <span class="n">nlpaug.augmenter.word</span> <span class="k">as</span> <span class="n">naw</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Those who can imagine anything, can create the impossible.</span><span class="sh">"</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">aug</span> <span class="o">=</span> <span class="n">naw</span><span class="p">.</span><span class="nc">SynonymAug</span><span class="p">(</span><span class="n">aug_src</span><span class="o">=</span><span class="sh">"</span><span class="s">wordnet</span><span class="sh">"</span><span class="p">)</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">aug</span><span class="p">.</span><span class="nf">augment</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">augmented</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">augmented_texts</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">src : </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">dst : </span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 출력 결과
# src : Those who can imagine anything, can create the impossible.
# dst : Those world health organization can reckon anything, can create the unimaginable.
</span></pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">SynonyAug</code> 클래스는 워드넷(WordNet) 데이터베이스나 의역 데이터베이스(PPDB)를 활용해 단어를 대체해 데이터를 증강한다.</li>
  <li>해당 기능은 문맥을 파악해 동의어로 변경하는 것이 아니라 데이터베이스 내 유의어나 동의어로 변경하므로 본래의 문맥과 전혀 다른 문장이 생성될 수 있다.
    <ul>
      <li>모델을 활용하고 싶은 경우에는 <code class="language-plaintext highlighter-rouge">ContextualWordEmbsAug</code> 클래스를 사용한다.</li>
    </ul>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">ReservedAug</code> 클래스를 사용해 단어를 대체할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="c1"># 단어 대체
</span><span class="kn">import</span> <span class="n">nlpaug.augmenter.word</span> <span class="k">as</span> <span class="n">naw</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Those who can imagine anything, can create the impossible.</span><span class="sh">"</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">reserved_tokens</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="sh">"</span><span class="s">can</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">can</span><span class="sh">'</span><span class="s">t</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">cannot</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">could</span><span class="sh">"</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">reserved_aug</span> <span class="o">=</span> <span class="n">naw</span><span class="p">.</span><span class="nc">ReservedAug</span><span class="p">(</span><span class="n">reserved_tokens</span><span class="o">=</span><span class="n">reserved_tokens</span><span class="p">)</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">reserved_aug</span><span class="p">.</span><span class="nf">augment</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">augmented</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">augmented_texts</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">src : </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">dst : </span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 출력 결과
# src : Those who can imagine anything, can create the impossible.
# dst: Those who can't imagine anything, could create the impossible.
</span></pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ReservedAug</code> 클래스는 입력 데이터에 포함된 단어를 특정한 단어로 대체하는 기능을 제공한다.</li>
  <li>가능한 모든 조합을 생성하거나 특정 글자나 문자를 <code class="language-plaintext highlighter-rouge">reserved_tokens</code>에서 선언한 데이터로 변경한다.</li>
</ul>

<h4 id="역번역"><span class="me-2">역번역</span><a href="#역번역" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>역번역(Back-translation)</strong>이란 입력 텍스트를 특정 언어로 번역한 다음 다시 본래의 언어로 번역하는 방법을 의미한다.</p>

<ul>
  <li>본래의 언어로 번역하는 과정에서 원래 텍스트와 유사한 텍스트가 생성되므로 <strong>패러프레이징(Paraphrasing)</strong> 효과를 얻을 수 있다.</li>
  <li>번역 모델의 성능에 크게 자우되며 번역이 정확하지 않거나 입력된 텍스트가 너무 복잡하고 어려운 구조를 갖고 있다면 성능이 크게 떨어지는 문제가 있다.
    <ul>
      <li>기계 번역의 품질을 평가하는데 사용되기도 함</li>
    </ul>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">BackTranslationAug</code> 클래스를 사용해 역번역을 적용할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="c1"># 역번역
</span><span class="kn">import</span> <span class="n">nlpaug.augmenter.word</span> <span class="k">as</span> <span class="n">naw</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Those who can imagine anything, can create the impossible.</span><span class="sh">"</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">back_translation</span> <span class="o">=</span> <span class="n">naw</span><span class="p">.</span><span class="nc">BackTranslationAug</span><span class="p">(</span>
    <span class="n">from_model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">facebook/wmt19-en-de</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">to_model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">facebook/wmt19-de-en</span><span class="sh">"</span>
<span class="p">)</span>
<span class="n">augmented_texts</span> <span class="o">=</span> <span class="n">back_translation</span><span class="p">.</span><span class="nf">augment</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">augmented</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">augmented_texts</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">src : </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">dst : </span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 출력 결과
# src : Those who can imagine anything, can create the impossible.
# dst : Anyone who can imagine anything can achieve the impossible.
</span></pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">BackTranslationAug</code> 클래서는 입력 모델(<code class="language-plaintext highlighter-rouge">from_model_name</code>)과 출력 모델(<code class="language-plaintext highlighter-rouge">to_model_name</code>)을 설정해 역번역을 수행할 수 있다.</li>
  <li>원문과 번역본의 의미가 크게 달라지지 않지만 번역 모델의 성능에 따라 결과가 크게 달라질 수 있다.</li>
  <li>두 개의 모델을 활용하므로 데이터 증강 방법 중 가장 많은 리소스를 소모한다.</li>
</ul>

<h3 id="이미지-데이터"><span class="me-2">이미지 데이터</span><a href="#이미지-데이터" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>이미지 데이터 증강은 객체 검출 및 인식, 이미지 분류와 같은 이미지 처리 모델을 구성할 때 데이터 세트의 크기를 쉽게 늘리기 위해 사용된다. 이미지 데이터 증강 방법은 크게 회전, 대칭, 이동, 크기 조정 등이 있다.</p>

<p>토치 비전(<code class="language-plaintext highlighter-rouge">torchvision</code>) 라이브러리와 **이미지 증강(<code class="language-plaintext highlighter-rouge">imgaug</code>) 라이브러리를 활용해 이미지 데이터를 증강할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># 이미지 증강 라이브러리 설치
</span><span class="n">pip</span> <span class="n">install</span> <span class="n">imgaug</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="변환-적용-방법"><span class="me-2">변환 적용 방법</span><a href="#변환-적용-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이미지 데이터 증강 방법은 토치비전 라이브러리의 <code class="language-plaintext highlighter-rouge">transforms</code> 모듈을 통해 수행할 수 있다. 변환 모듈에 이미지 변환에 관련된 기능이 포함돼 있으며, 여러 모델 매개변수를 묶어주는 <code class="language-plaintext highlighter-rouge">Compose</code> 클래스를 함께 사용해 증강을 적용한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="c1"># 통합(Compose) 클래스 및 변환 적용 방식
</span><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="n">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">Resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)),</span> <span class="c1"># 이미지 사이즈 변환
</span>        <span class="n">transforms</span><span class="p">.</span><span class="nc">ToTensor</span><span class="p">()</span>   <span class="c1"># 텐서 타입으로 변환
</span>    <span class="p">]</span>
<span class="p">)</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">../datasets/images/cat.jpg</span><span class="sh">"</span><span class="p">)</span>
<span class="n">transformed_image</span> <span class="o">=</span> <span class="nf">transform</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>이미지 증강은 어떤한 순서로 진행하는가에 따라 픽셀 데이터의 변환 폭과 결과물이 크게 달라질 수 있으며 여러 번 나눠 이미지 증강을 적용하면 코드가 복잡해진다.
    <ul>
      <li>문제를 해결하기 위해 증강 방법을 정렬하고 하나로 묶으는 <strong>데이터 핸들링(Data Handling)</strong>을 수행할 수 있다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">transforms.ToTensor</code> : <code class="language-plaintext highlighter-rouge">PIL.Image</code> 형식을 <code class="language-plaintext highlighter-rouge">Tensor</code> 형식으로 변환하며 [0~255] 범위의 픽셀값을 [0.0~1.0] 사이의 값으로 <strong>최대 최소 정규화</strong>를 수행하며 [높이, 너비, 채널] 형태를 [채널, 높이, 너비] 형태로 변환한다.</li>
</ul>

<p>대부분의 이미지 증강 클래스는 <code class="language-plaintext highlighter-rouge">PIL.Image</code> 형식을 대상으로 변환하고 파이토치에서는 <code class="language-plaintext highlighter-rouge">Tensor</code> 형식을 사용하므로 <code class="language-plaintext highlighter-rouge">PIL.Image</code> 형식을 증강 자체에서 변환해 활용한다.</p>

<p>만약 데이터세트에 일괄 적용한다면 <code class="language-plaintext highlighter-rouge">torchvision.datasets.ImageFolder</code>와 같은 이미지 데이터세트 클래스의 <code class="language-plaintext highlighter-rouge">transform</code> 매개변수에 입력해 활용할 수 있다.</p>

<h4 id="회전-및-대칭"><span class="me-2">회전 및 대칭</span><a href="#회전-및-대칭" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>학습 이미지를 회전하거나 대칭한다면 변형된 이미지가 들어오더라도 더 강건한 모델을 구축할 수 있으며 일반화된 성능을 끌어낼 수 있다.</p>

<p>하지만 이미지 변형을 과도하게 증강하면 본래의 특징이 소실될 수 있으며, 실제 데이터에 존재하지 않는 데이터가 생성될 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c1"># 회전 및 대칭
</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomHorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomVerticalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">RandomRotation</code>는 입력된 각도(<code class="language-plaintext highlighter-rouge">degree</code>)를 음수부터 양수 사이의 각도로 변환한다.
    <ul>
      <li>임의의 범위를 설정하려면 시퀀스 형태로 입력한다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">expand</code>를 <code class="language-plaintext highlighter-rouge">True</code>로 할당한다면 회전하는 과정에서 생기는 여백이 생성되지 않는다.</li>
  <li>중심점은 시퀀스 형태로 전달하지 않으면 왼쪽 상단을 기준으로 회전한다.</li>
  <li><code class="language-plaintext highlighter-rouge">RandomHorizontalFlip</code>과 <code class="language-plaintext highlighter-rouge">RandomVerticalFlip</code>은 수행 확룔(<code class="language-plaintext highlighter-rouge">p</code>)을 활용해 대칭 여부를 설정한다.</li>
</ul>

<h4 id="자르기-및-패딩"><span class="me-2">자르기 및 패딩</span><a href="#자르기-및-패딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>객체 인식과 같은 모델을 구성할 때는 주요한 객체가 일부 영역에만 작게 존재할 수 있다. 이러한 경우 객체가 존재하는 위치로 이미지를 잘라 불필요한 특징을 감소시키거나 패딩을 주어 이미지 크기를 동일한 크기로 맞출 수 있다.</p>

<p>하지만 이미지를 과도하게 잘라 검출하려는 객체가 포함되지 않거나 너무 많은 패딩을 주어 특징의 영향이 감소할 수도 있으므로 주의해 사용해야 한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1"># 자르기 및 패딩
</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">padding_mode</span><span class="o">=</span><span class="sh">"</span><span class="s">constant</span><span class="sh">"</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">RandomCrop</code>은 정수나 시퀀스 형태로 값을 입력할 수 있다.
    <ul>
      <li>정수로 입력한다면 이미지의 높이와 너비가 동일한 정사각형 이미지로 잘린다.</li>
      <li>시퀀스로 입력하는 경우 (높이, 너비) 순서로 이미지를 자른다.</li>
      <li>패딩을 줄 수 있는데 이 방식은 자를 때 발생하는 여백 공간 할당 방법을 설정한다.</li>
    </ul>
  </li>
  <li>패딩 클래스(<code class="language-plaintext highlighter-rouge">Pad</code>)는 이미지 테두리에 특정한 방식이나 고정값으로 이미지를 확장하는 기능을 제공한다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">padding_mode</code>는 상수(<code class="language-plaintext highlighter-rouge">constant</code>)로 입력하면 RGB(127, 127, 255)로 테두리가 생성된다.</li>
      <li>반사(<code class="language-plaintext highlighter-rouge">reflect</code>)나 대칭(<code class="language-plaintext highlighter-rouge">symmetric</code>)으로 준다면 입력한 RGB는 무시되면 이미지의 픽셀값을 반사하거나 대칭해 생성한다.</li>
    </ul>
  </li>
</ul>

<h4 id="크기-조정"><span class="me-2">크기 조정</span><a href="#크기-조정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이미지 처리 모델 학습을 원활하게 진행하기 위해서는 학습 데이터에 사용되는 이미지의 크기가 모두 일정해야 한다. 데이터 자체를 수정하면 향후 모델이 입력받는 이미지 크기가 달라졌을 때 데이터 관리에 어려움이 생긴다. 이를 방지하기 위해 증강 클래스에서 이미지 크기를 변환한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># 크기 조정
</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">Resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Resize</code> 클래스는 크기(<code class="language-plaintext highlighter-rouge">size</code>) 매개변수를 정수 또는 시퀀스로 입력받는다.
    <ul>
      <li>정수로 크기를 입력받는 경우 높이나 너비 중 크기가 더 작은 값에 비율을 맞춰 크기가 수정된다.
        <ul>
          <li>ex. (500, 400)일 때 300을 입력받으면 (375, 300)으로 수정됨</li>
        </ul>
      </li>
      <li>시퀀스 형태로 입력하여 명시적으로 크기를 설정하며 일반적으로 정사각형으로 데이터를 정규화한다.</li>
    </ul>
  </li>
</ul>

<h4 id="변형"><span class="me-2">변형</span><a href="#변형" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이미지를 변형하는 경우 <strong>기하학적 변환(Geometric Transform)</strong>을 통해 이미지를 변경한다. 기하학적 변환이란 인위적으로 확대, 축소, 위치 변경, 회전, 왜곡하는 등 이미지 형태를 변환하는 것을 의미한다. 대표적으로 아핀 변환과 원근 변환이 있다.</p>

<ul>
  <li>아핀 변환: 2 $\times$ 3 행렬을 사용하며 행렬 곱셈에 벡터 합을 활용해 표현할 수 있는 변환</li>
  <li>
    <p>원근 변환: 3 $\times$ 3 행렬을 사용하며, 호모그래피로 모델링할 수 있는 변환</p>

    <blockquote>
      <p>호모그래피(Homography)는 <strong>두 평면 사이의 투시 변환(Perspective transform)</strong>을 의미한다.</p>
    </blockquote>

    <p><a href="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FsMAIW%2FbtqK70OB0YS%2F1F4puYKWQ0GnSPhmgrlC0K%2Fimg.png" class="popup img-link shimmer"><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FsMAIW%2FbtqK70OB0YS%2F1F4puYKWQ0GnSPhmgrlC0K%2Fimg.png" loading="lazy"></a></p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c1"># 아핀 변환
</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomAffine</span><span class="p">(</span>
            <span class="n">degrees</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
            <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">shear</span><span class="o">=</span><span class="mi">15</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>아핀 변환은 각도(<code class="language-plaintext highlighter-rouge">degree</code>), 이동(<code class="language-plaintext highlighter-rouge">translate</code>), 척도(<code class="language-plaintext highlighter-rouge">scale</code>), 전단(<code class="language-plaintext highlighter-rouge">shear</code>)을 입력해 이미지를 변형한다.</li>
  <li>회전이나 이동 이외에도 중심점(원점)에서 임의로 설정된 점을 향하는 벡터를 선형 변환하므로 이미지가 눕혀지거나 비틀어진 결과물을 얻을 수 있다.</li>
  <li>이미지의 축을 비트는 것처럼 변환되므로 특징들을 유지하지만, 이미지 픽셀들이 큰 폭으로 변환되므로 가장 많은 변형이 일어난다.</li>
</ul>

<h4 id="색상-변환"><span class="me-2">색상 변환</span><a href="#색상-변환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이미지 데이터의 특징은 픽셀값의 분포나 패턴에 크게 좌우된다. 모델이 이미지를 분석할 때 특정 색상에 편향되지 않도록 픽셀값을 변환하거나 정규화하면 모델을 더 일반화해 분석 성능을 향상시키고 학습 시간을 단축할 수 있다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c1"># 색상 변환 및 정규화
</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">ColorJitter</span><span class="p">(</span>
            <span class="n">brightness</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">saturation</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="mf">0.3</span>
        <span class="p">),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">ToTensor</span><span class="p">(),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">Normalize</span><span class="p">(</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span>
            <span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="n">transforms</span><span class="p">.</span><span class="nc">ToPILImage</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ColorJitter</code>는 이미지의 밝기(<code class="language-plaintext highlighter-rouge">brightness</code>), 대비(<code class="language-plaintext highlighter-rouge">contrast</code>), 채도(<code class="language-plaintext highlighter-rouge">saturation</code>), 색상(<code class="language-plaintext highlighter-rouge">hue</code>)을 변환한다.
    <ul>
      <li>이미지는 거리나 조명 등에 의해 색상이 크게 달라지는데 색상 변환을 통해 간접적으로 데이터세트의 일반화 효과를 얻을 수 있다.</li>
      <li>객체 검출이나 인식 과정에서 색상이 중요하지 않고 형태(Shape)가 더 중요한 경우 형태를 유지하면서 색상 톤을 낮출 수 있다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Normalize</code>는 픽셀의 평균과 표준편차를 활용해 정규화한다. 이는 데이터를 정규화해 모델 성능을 높이는 데 중점을 둔다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Tensor</code> 형식을 입력으로 받으며 정규화 방식은 (<code class="language-plaintext highlighter-rouge">input[channel]</code> - <code class="language-plaintext highlighter-rouge">mean[channel]</code>) / <code class="language-plaintext highlighter-rouge">std[channel]</code> 로 진행된다.</li>
      <li>본래 픽셀값을 확인하려면 <strong>역정규화(Denormalization)</strong>를 수행한다.</li>
    </ul>
  </li>
</ul>

<h4 id="노이즈"><span class="me-2">노이즈</span><a href="#노이즈" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이미지 처리 모델은 주로 합성곱 연산을 통해 학습을 진행하기 때문에 픽셀값에 따라 특징을 추출하는 매개변수가 크게 달라질 수 있다.</p>

<ul>
  <li>노이즈 추가는 특정 픽셀값에 편향되지 않도록 임의의 노이즈를 추가헤 모델의 일반화 능력을 높이는데 사용된다.</li>
  <li>학습에 직접 포함되지 않더라도 테스트 데이터에 노이즈를 추가해 일반화 능력이나 <strong>강건성(Robustness)</strong>을 평가하는 데 사용된다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c1"># 노이즈 추가
</span><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="n">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="n">imgaug</span> <span class="kn">import</span> <span class="n">augmenters</span> <span class="k">as</span> <span class="n">iaa</span>

<span class="k">class</span> <span class="nc">IaaTransforms</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>    <span class="c1"># 증강 방법을 설정
</span>        <span class="n">self</span><span class="p">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">iaa</span><span class="p">.</span><span class="nc">Sequential</span><span class="p">([</span>
            <span class="n">iaa</span><span class="p">.</span><span class="nc">SaltndPepper</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)),</span>
            <span class="n">iaa</span><span class="p">.</span><span class="nc">Rain</span><span class="p">(</span><span class="n">spped</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
        <span class="p">])</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">images</span><span class="p">):</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">augmented</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">seq</span><span class="p">.</span><span class="nf">augment_image</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Image</span><span class="p">.</span><span class="nf">fromarray</span><span class="p">(</span><span class="n">augmented</span><span class="p">)</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span>
    <span class="nc">IaaTransforms</span><span class="p">()</span>
<span class="p">])</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>이미지 증강 라이브러리의 증강 클래스는 넘파이의 <code class="language-plaintext highlighter-rouge">ndarray</code> 클래스를 입력값과 출력값으로 사용한다.</li>
  <li>토치비전은 <code class="language-plaintext highlighter-rouge">PIL.Image</code> 형식이나 <code class="language-plaintext highlighter-rouge">Tensor</code> 형식으로 증강을 적용하므로 <code class="language-plaintext highlighter-rouge">IaaTransforms</code> 클래스를 선언해 적용한다.</li>
  <li>초기화 메서드에는 증강 방법을 설정하고 호출 메서드에서는 <code class="language-plaintext highlighter-rouge">ndarray</code> 형식 변환과 <code class="language-plaintext highlighter-rouge">augment_image</code> 메서드로 증강을 적용한 후 다시 <code class="language-plaintext highlighter-rouge">PIL.Image</code> 형식으로 변환해 반환한다.</li>
</ul>

<h4 id="컷아웃-및-무작위-지우기"><span class="me-2">컷아웃 및 무작위 지우기</span><a href="#컷아웃-및-무작위-지우기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>컷아웃(Cutout)</strong>과 <strong>무작위 지우기(Random Erasing)</strong>는 증강 및 정칙화 방법이다.</p>

<ul>
  <li>컷아웃은 이미지에서 임의의 사각형 영역을 삭제하고 0의 픽셀값으로 채우는 방법이다.
    <ul>
      <li>동영상에서 <strong>폐색 영역(Occlusion)</strong>에 대해 모델이 더 강건하게 해준다.</li>
    </ul>
  </li>
  <li>무작위 지우기는 임의의 사각형 영역을 삭제하고 무작위 픽셀값으로 채우는 방법이다.
    <ul>
      <li>일부 영역이 누락되거나 잘렸을 때 더 강건한 모델을 만둘 수 있게 한다.</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>폐색 영역은 앞에 있는 물체가 뒤에 있는 물체의 일부 또는 전부를 가려진 부분을 말한다.</p>
</blockquote>

<p>두 가지 방법 모두 이미지의 객체가 일부 누락되더라도 모델을 견고하게 만드는 증강 방법이다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1"># 무작위 지우기
</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="p">.</span><span class="nc">ToTenser</span><span class="p">(),</span>
    <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomErasing</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">transforms</span><span class="p">.</span><span class="nc">RandomErasing</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sh">"</span><span class="s">random</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">transforms</span><span class="p">.</span><span class="nc">ToPILImage</span><span class="p">()</span>
<span class="p">])</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>컷아웃과 무작위 지우기 모두 <code class="language-plaintext highlighter-rouge">RandomErasing</code>을 통해 적용할 수 있다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">value</code>를 0으로 할당하면 컷아웃 방법이 되며, <code class="language-plaintext highlighter-rouge">random</code>으로 입력하면 무작위 지우기 방법이 된다.</li>
    </ul>
  </li>
  <li>무작위 지우기 클래스는 <code class="language-plaintext highlighter-rouge">Tensor</code> 형식만 지원되므로 해당 클래스를 호출하기 전에 텐서 변환 클래스를 호출해 <code class="language-plaintext highlighter-rouge">Tensor</code> 형식으로 변환해야 한다.</li>
</ul>

<h4 id="혼합-및-컷믹스"><span class="me-2">혼합 및 컷믹스</span><a href="#혼합-및-컷믹스" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>혼합(Mixup)</strong>은 두 개 이상의 이미지를 혼합해 새로운 이미지를 생성하는 방법이며 픽셀값을 선형으로 결합해 새 이미지를 생성한다.</p>

<ul>
  <li>생성된 이미지는 두 개의 이미지가 겹쳐 흐릿한 형상을 지니게 된다.</li>
  <li>혼합 방식으로 이미지 데이터를 증강해 학습하면 레이블링이 다르게 태깅돼 있어도 더 낮은 오류를 보이며, 이미지를 혼합했기 때문에 <strong>다중 레이블(Multi-label)</strong> 문제에 대해서도 더 견고한 모델을 구성할 수 있다.</li>
</ul>

<p><strong>컷믹스(CutMix)</strong>는 이미지 패치(patch) 영역에 다른 이미지를 덮어씌우는 방법이다. 이미지 영역을 잘라내고 붙여넣기(Cut and paste)하는 방법으로 볼 수 있다.</p>

<ul>
  <li>패치 위에 새로운 페치를 덮어씌워 비교적 자연스러운 이미지를 구성한다.</li>
  <li>모델이 이미지의 특정 영역을 기억해 인식하는 문제를 완화하여, 이미지 전체를 보고 판단할 수 있게 일반화한다.</li>
</ul>

<p><a href="/../assets/img/post/pytorch-book/mixup_cutmix.png" class="popup img-link shimmer"><img src="/../assets/img/post/pytorch-book/mixup_cutmix.png" width="480" height="300" loading="lazy"></a></p>

<p>이 두 방식의 차이점으로 혼합은 이미지 크기만 맞다면 쉽게 혼합할 수 있지만, 컷믹스는 패치 영역의 크기와 비율을 고려해 덮어씌워야 한다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="c1"># 혼합
</span><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="n">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>

<span class="k">class</span> <span class="nc">Mixup</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="n">self</span><span class="p">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">self</span><span class="p">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">image</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="nf">resize</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="n">mix_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">target</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">beta</span>
        <span class="k">return</span> <span class="n">Image</span><span class="p">.</span><span class="nf">fromarray</span><span class="p">(</span><span class="n">mix_image</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">))</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="p">.</span><span class="nc">Resize</span><span class="p">((</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)),</span>
    <span class="nc">Mixup</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">../datasets/images/dog.jpg</span><span class="sh">"</span><span class="p">),</span>
        <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">beta</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">target</code>은 혼합하려는 이미지를 입력하고 <code class="language-plaintext highlighter-rouge">scale</code>을 통해 이미지 조절한다.</li>
  <li><code class="language-plaintext highlighter-rouge">alpha</code>와 <code class="language-plaintext highlighter-rouge">beta</code>는 각 이미지의 혼합 비율을 설정한다.</li>
  <li>호출 메서드에서 간단한 넘파이 연산으로 두 이미지를 혼합할 수 있다.</li>
</ul>

<p>텍스트 및 이미지 증강 방법은 모든 데이터에 적용하는 것이 아닌, 일부 데이터에만 적용해 증강한다. 또한 색상 변환이나 정규화 같이 픽셀 데이터의 형태를 완전히 바꾸는 경우 모델 추론 과정에서도 동일한 증강 방법이나 정규화 방법을 적용해야 모델이 데이터를 분석해 값을 인식할 수 있다.</p>

<p>데이터 증강은 모델 학습에 있어서 보편적으로 사용되는 방법이며, 부족한 데이터를 확보하고 모델의 일반화 성능을 최대로 끌어올릴 수 있다.</p>

<h2 id="사전-학습된-모델"><span class="me-2">사전 학습된 모델</span><a href="#사전-학습된-모델" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<p><strong>사전 학습된 모델(Pre-trained Model)</strong>이란 대규모 데이터세트로 학습된 딥러닝 모델로 이미 학습이 완료된 모델을 의미한다. 이 모델 자체를 현재 시스템에 적용하거나 사전 학습된 <strong>임베딩(Embedding)</strong> 벡터를 활용해 모델을 구성할 수 있다.</p>

<ul>
  <li>
    <p>사전 학습된 모델을 활용한다면 처음부터 모델을 구성하고 학습하는 것이 이닌 이미 학습된 모델의 일부를 활용하거나 추가 학습을 통해 모델의 성능을 끌어낼 수 있다.</p>

    <p>ex) 늑대와 사자를 구별하는 모델을 구축한다고 가정 → 처음부터 모델을 학습하지 않고 개와 고양이를 구별하는 사전 학습된 모델을 활용해 모델 구축</p>
  </li>
  <li>사전 학습된 모델은 이미 다양한 작업에서 성능을 검증한 모델이므로 안정되고 우수한 성능을 기대할 수 있다.</li>
  <li>대규모 데이터세트에서 데이터의 특징을 학습했으므로 유사한 작업에 대해서도 우수한 성능을 기대할 수 있다.</li>
</ul>

<p>사전 학습된 모델은 <strong>전이 학습(Transfer Learning)</strong>과 같은 작업뿐만 아니라 <strong>백본 네트워크(Backbone Networks)</strong>로 사용되며, 대규모 데이터에서 학습한 지식을 활용하여 소량의 데이터로도 우수한 성능을 달성할 수 있다.</p>

<h3 id="백본"><span class="me-2">백본</span><a href="#백본" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>백본(Backbone)</strong>이란 입력 데이터에서 특징을 추출해 최종 분류기에 전달하는 딥러닝 모델이나 딥러닝 모델의 일부를 의미한다.</p>

<ul>
  <li>백본에 대한 개념은 신경망 모델인 VGG, ResNet, Mask R-CNN 논문에 처음 등장했다.</li>
  <li>백본 네트워크는 입력 데이터에서 특징을 추출하므로 노이즈와 불필요한 특성을 제거하고 가장 중요한 특징을 추출하고 이를 활용해 새로운 모델이나 기능의 입력으로 사용한다.
    <ul>
      <li>객체 검출에서 합성곱 신경망의 초기 계층에서 점이나 선과 같은 저수준의 특징을 학습하고 중간 계층에서 객체나 형태, 최종 계층에서는 이전 계층의 특징을 기반으로 객체를 이해하고 검출</li>
      <li>포즈 추정, 이미지 분할로 확장하면 객체를 검출하는 합성곱 신경망의 특징값을 가져와 최종 계층을 바꿔 기존 모델과 다른 모델을 구성할 수 있다.</li>
    </ul>
  </li>
</ul>

<p>모델을 구성할 때 백본을 활용한다고 해서 모델의 성능이 급격하게 좋아지지는 않으며 장단점이 모두 존재한다. 그러므로 적합한 백본을 선택해야 한다.</p>

<ul>
  <li>백본으로 사용하는 딥러닝 모델에는 많은 수의 매개변수가 존재하며 학습 데이터에 따라 쉽게 과대적합될 수 있다.
    <ul>
      <li>방지하기 위해 정규화 또는 정칙화 기술을 적용할 것을 권장</li>
    </ul>
  </li>
  <li>사전 학습된 백본은 미세 조정이나 전이 학습을 적용해 과대적합을 피해야 한다.</li>
  <li>현재 작업에 적합한 백본을 찾기 위해 다양한 백본을 적용해 가며 성능 모니터링이 필요하다.</li>
</ul>

<p>자연어 처리와 컴퓨터비전 작업에서 백본이 되는 모델은 BERT, GPT, VGG-16, RestNet과 같은 <strong>초대규모 딥러닝 모델</strong>을 사용한다.</p>

<h3 id="전이-학습"><span class="me-2">전이 학습</span><a href="#전이-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>전이 학습(Transfer Learning)</strong>이란 어떤 작업을 수행하기 위해 이미 사전 학습된 모델을 재사용해 새로운 작업이나 관련 <strong>도메인(Domain)</strong>의 성능을 향상시킬 수 있는 기술을 의미한다.</p>

<ul>
  <li>특정 영역의 대규모 데이터세트에서 사전 학습된 모델을 다른 영역의 작은 데이터세트로 미세 조정해 활용한다.</li>
  <li>기존 머신러닝 모델이 학습했던 데이터 특징을 학습하여 <strong>소스 도메인(Source Domain)</strong>에서 학습한 지식을 활용해 <strong>타깃 도메인(Target Domain)</strong>에서 모델의 성능을 향상시키는 것이다.</li>
</ul>

<p>즉, 전이 학습은 사전 학습된 모델을 활용해 현재 시스템에 맞는 새로운 모델로 학습하는 과정이다.</p>

<ul>
  <li>모델을 구축하면 소스 도메인에서 학습한 지식을 재사용하여 전이 학습된 모델이 더 적은 데이터와 학습 시간으로 더 높은 성능을 낼 수 있다.</li>
  <li>기존의 학습에서 대규모 데이터세트를 활용한 사전 학습된 모델을 활용하므로 과대적합 문제를 최소화할 수 있다.</li>
</ul>

<p><a href="/../assets/img/post/pytorch-book/transfer_learning.png" class="popup img-link shimmer"><img src="/../assets/img/post/pytorch-book/transfer_learning.png" width="480" height="400" loading="lazy"></a></p>

<p>전이 학습은 사전 학습된 모델과 미세 조정된 모델의 관계를 설명하기 위해 <strong>업스트림(Upstream)</strong>과 <strong>다운스트림(Downstream)</strong> 영역으로 구별된다.</p>

<ul>
  <li>업스트림 모델은 전이 학습을 수행하기 위해 사전 학습된 모델을 말한다.</li>
  <li>다운스트림 모델은 미세 조정된 모델을 말하며 업스트림 모델에서 학습한 지식을 활용해 작은 규모의 타깃 도메인 데이터세트에서 학습한 모델이다.
    <ul>
      <li>전이 학습 파이프라인 중 마지막 부분에 위치</li>
    </ul>
  </li>
  <li>다운스트림 모델은 사전 학습된 모델의 계층을 하나 이상 사용하며 타깃 도메인에 적응하기 위해 소규모 데이터세트에서 미세 조정된다.</li>
</ul>

<h4 id="귀납적-전이-학습"><span class="me-2">귀납적 전이 학습</span><a href="#귀납적-전이-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>귀납적 전이 학습(Inductive Transfer Learning)</strong>은 기존에 학습한 모델의 지식을 활용하여 새로운 작업을 수행하기 위한 방법 중 하나로 이전 작업에서 학습한 지식을 새로운 작업에 활용함으로써 작업의 효율성을 높이고 모델의 일반화 능력과 성능을 향상시킬 수 있다.</p>

<p>귀납적 전이 학습은 <strong>자기주도적 학습(Self-taught Learning)</strong>과 <strong>다중 작업 학습(Multi-task Learning)</strong>으로 나뉜다.</p>

<ul>
  <li>자기주도적 학습이란 비지도 전이 학습의 유형 중 하나로, 소스 도메인의 데이터세트에서 데이터의 양은 많으나 레이블링된 데이터의 수가 매우 적거나 없을 때 사용하는 방법이다.
    <ul>
      <li>레이블이 지정되지 않은 대규모 데이터세트에서 특징을 추출하는 오토 인코더 같은 모델을 학습시킨 다음, 저차원 공간에서 레이블링된 데이터로 미세 조정을 한다.</li>
      <li>레이블이 지정된 데이터를 수집하는 데 리소스 소모가 큰 경우 유용하게 사용할 수 있다.</li>
    </ul>
  </li>
  <li>다중 작업 학습은 레이블이 지정된 소스 도메인과 타깃 도메인 데이터를 기반으로 모델에 여러 작업을 동시에 가르치는 방법을 의미한다.
    <ul>
      <li>모델 구조는 <strong>공유 계층</strong>과 <strong>작업별 계층</strong>으로 나뉜다.</li>
      <li>공유 계층에서는 소스 도메인과 타깃 도메인의 데이터세트에서 모델을 사전 학습한 다음 단일 작업을 위해 작업별 계층마다 타깃 도메인 데이터세트로 미세 조정하는 방법으로 모델을 구성한다.</li>
      <li>공유 계층에서 서로 다른 작업의 특징을 맞추기 위해 동시에 학습되므로 하나의 작업에 과대적합 되지 않아 일반화된 모델을 얻을 수 있고 서로의 작업이 동일한 도메인을 사용하므로 성능 향상에 기여할 수 있다는 장점이 있다.</li>
    </ul>
  </li>
</ul>

<h4 id="변환적-전이-학습"><span class="me-2">변환적 전이 학습</span><a href="#변환적-전이-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>변환적 전이 학습(Transductive Transfer Learning)</strong>은 소스 도메인과 타깃 도메인이 유사하지만 완전히 동일하지 않은 경우를 의미한다.</p>

<ul>
  <li>소스 도메인은 레이블이 존재하며, 타깃 도메인에는 레이블이 존재하지 않은 경우에 사용된다.
    <ul>
      <li>레이블이 지정된 소스 도메인으로 사전 학습된 모델을 구축하며, 레이블이 지정되지 않은 타깃 도메인으로 모델을 미세 조정한다.</li>
    </ul>
  </li>
  <li>변환적 전이 학습은 <strong>도메인 적응(Domain Adaptation)</strong>과 <strong>표본 선택 편향/공변량 이동(Sample Selection Bias/Covariance Shift)</strong>으로 나뉜다.
    <ul>
      <li>도메인 적응은 소스 도메인과 타깃 도메인의 <strong>특징 분포(Feature Distributions)</strong>를 전이시키는 방법이다.</li>
      <li>표본 선택 편향/공변량 이동은 소스 도메인과 타깃 도메인의 분산과 편향이 크게 다를 때 표본을 선택해 편향이나 공변량을 이동시키는 방법을 의미한다.</li>
    </ul>
  </li>
</ul>

<h4 id="비지도-전이-학습"><span class="me-2">비지도 전이 학습</span><a href="#비지도-전이-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>비지도 전이 학습(Unsupervised Transfer Learning)</strong>은 소스 도메인과 타깃 도메인 모두 레이블이 지정된 데이터가 없는 전이 학습 방법이다.</p>

<ul>
  <li>레이블이 없는 전체 데이터로 학습해 데이터가 가진 특징과 특성을 구분할 수 있게 사전 학습된 모델을 구축하고 소규모의 레이블이 지정된 데이터를 활용해 미세조정한다.</li>
  <li>레이블의 영향을 받지 않고 데이터가 가진 특징을 학습했으므로 미세 조정 시 더 효과적으로 타깃 도메인에 대해 예측을 수행할 수 있다.</li>
  <li>대표적으로 생성적 적대 신경망(GAN)과 군집화(Clustering)가 있다.</li>
</ul>

<h4 id="제로-샷-전이-학습"><span class="me-2">제로-샷 전이 학습</span><a href="#제로-샷-전이-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>제로-샷 전이 학습(Zero-shot Transfer Learning)</strong>은 사전 학습된 모델을 이용해 다른 도메인에서도 적용할 수 있는 전이 학습 기법 중 하나로 새로운 도메인에서 일반화된 성능을 가질 수 있다.</p>

<ul>
  <li>새로운 도메인에서 학습할 데이터가 부족한 경우에 유용하게 사용할 수 있다.</li>
  <li>다양한 도메인 간의 지식을 전이할 수 있기 때문에 일반환된 성능을 높일 수 있다.</li>
</ul>

<h4 id="원-샷-전이-학습"><span class="me-2">원-샷 전이 학습</span><a href="#원-샷-전이-학습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>원-샷 전이 학습(One-shot Transfer Learning)</strong>은 제로-샷 학습과 유사하지만, 한 번에 하나의 샘플만 사용해 모델을 학습하는 방법이다.</p>

<ul>
  <li>매우 적은 양의 데이터를 이용하여 분류 문제를 해결할 수 있다.</li>
  <li>원-샷 전이 학습 모델은 <strong>서포트 셋(Support Set)</strong>과 <strong>쿼리 셋(Query Set)</strong>을 가정한다.
    <ul>
      <li>서포트 셋은 학습에 사용될 클래스의 대표 샘플을 의미하며, 각 클래스당 하나 이상의 대표 샘플로 이뤄진다.</li>
      <li>쿼리 셋은 새로운 클래스를 분류하기 위한 입력 데이터를 의미하며, 분류 대상 데이터로, 서포트 셋에서 수집한 셈플과는 다른 샘플이어햐 한다.</li>
    </ul>
  </li>
  <li>서포트 셋에 있는 대표 샘플과 쿼리 셋 간의 거리를 측정하여 쿼리 셋과 가장 가까운 서포트 셋의 대표 샘플의 클래스로 분류한다.
    <ul>
      <li>거리 측정 방법으로는 유클리드 거리, 코사인 유사도 등이 사용된다.</li>
    </ul>
  </li>
</ul>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>유형</th>
      <th>세부 유형</th>
      <th>소스 도메인</th>
      <th>타깃 도메인</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>귀납적 전이 학습</td>
      <td>자기주도적 학습</td>
      <td>레이블링 없음</td>
      <td>레이블링 있음</td>
    </tr>
    <tr>
      <td>귀납적 전이 학습</td>
      <td>다중 작업 학습</td>
      <td>레이블링 있음</td>
      <td>레이블링 있음</td>
    </tr>
    <tr>
      <td>변환적 전이 학습</td>
      <td>-</td>
      <td>레이블링 있음</td>
      <td>레이블링 없음</td>
    </tr>
    <tr>
      <td>비지도 전이 학습</td>
      <td>-</td>
      <td>레이블링 없음</td>
      <td>레이블링 없음</td>
    </tr>
    <tr>
      <td>제로-샷 전이 학습</td>
      <td>-</td>
      <td>레이블링 있음</td>
      <td>레이블링 없음</td>
    </tr>
    <tr>
      <td>원-샷 전이 학습</td>
      <td>-</td>
      <td>레이블링 있음</td>
      <td>레이블링 없음</td>
    </tr>
  </tbody>
</table></div>

<h3 id="특징-추출-및-미세-조정"><span class="me-2">특징 추출 및 미세 조정</span><a href="#특징-추출-및-미세-조정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>특징 추출(Feature Extraction)</strong>및 <strong>미세 조정(Fine-tuning)</strong>은 전이 학습에 사용되는 일반적인 기술을 의미한다. 두 가지 방법 모두 대규모 데이터세트로 사전 학습된 모델을 작은 데이터세트로 추가 학습해 가중치나 편향을 수정한다. 이를 통해 재학습된 모델은 대규모 데이터세트에서 배운 지식을 적용해 새로운 데이터세트에 맞는 지식을 제공할 수 있다.</p>

<ul>
  <li>특징 추출: 타깃 도메인이 소스 도메인과 유사하고 타깃 도메인의 데이터세트가 적을 때 사용된다.
    <ul>
      <li>소스 도메인과 타깃 도메인이 매우 유사하면 타깃 도메인으로 모델을 학습해도 소스 도메인의 가중치나 편향도 유사하다.</li>
      <li>특칭 추출 계층은 <strong>동결(Freeze)</strong>해 학습하지 않고 기존에 학습된 모델의 가중치를 사용한다.</li>
      <li>예측 모델마다 요구하는 출력 노드의 수가 다르므로 모델의 분류기(Classifier)만 재구성해 학습한다.</li>
    </ul>
  </li>
  <li>미세 조정은 특징 추출 계층을 일부만 동결하거나 동결하지 않고 타깃 도메인에 대한 학습을 진행한다.
    <ul>
      <li>소스 도메인과 타깃 도메인 간 유사성은 매우 낮지만 특징 추출을 위한 부분은 필요할 떄 사용하며 이 경우 데이터 세트가 충분히 많을 때 시도할 수 있음</li>
      <li>타깃 도메인에 대한 데이터세트가 작아 전체 계층을 학습할 수 없는 경우 일부 계층만 동결에 진행
        <ul>
          <li>하위 계층에서 저수준의 특징을 학습할 때 동일한 특징으로 학습될 가능성이 높으므로 초기 계층만 동결</li>
        </ul>
      </li>
      <li>소스 도메인과 타깃 도메인이 유사하지만, 충분한 데이터세트를 확보하지 못한 경우 특징 추출 방법을 통해 모델을 학습
        <ul>
          <li>데이터세트가 충분히 많지 않기 때문에 상위 계층으로 가면서 특징이 점점 달라지기 때문에 하위 계층을 동결하고 일부 상위 계층을 학습하는 방법으로 모델을 구축</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><a href="/../assets/img/post/pytorch-book/fine_tuning.png" class="popup img-link shimmer"><img src="/../assets/img/post/pytorch-book/fine_tuning.png" loading="lazy"></a></p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>데이터</th>
      <th>특징 유사도</th>
      <th>미세 조정 전략</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>적음</td>
      <td>높음</td>
      <td>분류기만 학습</td>
    </tr>
    <tr>
      <td>많음</td>
      <td>낮음</td>
      <td>분류기 + 모델 매개변수 학습</td>
    </tr>
    <tr>
      <td>적음</td>
      <td>낮음</td>
      <td>초기 계층을 제외한 나머지 계층 + 분류기 학습</td>
    </tr>
    <tr>
      <td>많음</td>
      <td>높음</td>
      <td>상위 계층 + 분류기 학습</td>
    </tr>
  </tbody>
</table></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/deep-learning/">Deep Learning</a>,
          <a href="/categories/%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98-%ED%8A%B8%EB%9E%9C%EC%8A%A4%ED%8F%AC%EB%A8%B8%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%9E%90%EC%97%B0%EC%96%B4-%EC%B2%98%EB%A6%AC%EC%99%80-%EC%BB%B4%ED%93%A8%ED%84%B0-%EB%B9%84%EC%A0%84-%EC%8B%AC%EC%B8%B5%ED%95%99%EC%8A%B5/">파이토치 트랜스포머를 활용한 자연어 처리와 컴퓨터 비전 심층학습</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/pytorch/"
            class="post-tag no-text-decoration"
          >pytorch</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%20%EC%8B%AC%ED%99%94(2)%20-%20Seojin%20Devlog&url=http%3A%2F%2Flocalhost%3A4000%2Fpytorch-book%2Fpytorch%2Fadvance-2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%20%EC%8B%AC%ED%99%94(2)%20-%20Seojin%20Devlog&u=http%3A%2F%2Flocalhost%3A4000%2Fpytorch-book%2Fpytorch%2Fadvance-2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fpytorch-book%2Fpytorch%2Fadvance-2%2F&text=%ED%8C%8C%EC%9D%B4%ED%86%A0%EC%B9%98%20%EC%8B%AC%ED%99%94(2)%20-%20Seojin%20Devlog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/boostcamp/pre-course/probability-theory/">인공지능 확률론</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/boostcamp/pre-course/statistics/">인공지능 통계학 기초</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/pytorch-book/cv/image-classification/">이미지 분류</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/boostcamp/pre-course/deeplearning/">딥러닝 기초 - 선형모델부터 역전파까지</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/boostcamp/pre-course/basic_math/">인공지능을 위한 수학</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ml/">ml</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/scikit-learn/">scikit-learn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/naver-boostcamp/">Naver-Boostcamp</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nlp/">NLP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pre-course/">Pre-Course</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pytorch/">pytorch</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/supervised-learning/">supervised-learning</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-structure/">data-structure</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/pytorch-book/pytorch/advance-1/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1750345200"
  data-df="ll"
  
>
  Jun 20, 2025
</time>

              <h4 class="pt-0 my-2">파이토치 심화(1)</h4>
              <div class="text-muted">
                <p>과대적합과 과소적합 / 배치 정규화 / 가중치 초기화</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/pytorch-book/pytorch/basic-3/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1749999600"
  data-df="ll"
  
>
  Jun 16, 2025
</time>

              <h4 class="pt-0 my-2">파이토치 기초(3)</h4>
              <div class="text-muted">
                <p>활성화 함수 / 순전파와 역전파 / 퍼셉트론</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/pytorch-book/pytorch/basic-2/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745938800"
  data-df="ll"
  
>
  Apr 30, 2025
</time>

              <h4 class="pt-0 my-2">파이토치 기초(2)</h4>
              <div class="text-muted">
                <p>데이터 세트와 데이터 로더 / 모델 &amp; 데이터세트 분리 / 모델 저장 및 불러오기</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/pytorch-book/pytorch/advance-1/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>파이토치 심화(1)</p>
    </a>
  

  
    <a
      href="/math/linear-algebra_1/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>선형대수학의 기초</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/username">Seojin Park</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ml/">ml</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/scikit-learn/">scikit-learn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/naver-boostcamp/">Naver-Boostcamp</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nlp/">NLP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pre-course/">Pre-Course</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pytorch/">pytorch</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/supervised-learning/">supervised-learning</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-structure/">data-structure</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->

  
  <!-- https://utteranc.es/ -->
<script>
  (function () {
    const origin = 'https://utteranc.es';
    const themeMapper = Theme.getThemeMapper('github-light', 'github-dark');
    const initTheme = themeMapper[Theme.visualState];

    let script = document.createElement('script');
    script.src = 'https://utteranc.es/client.js';
    script.setAttribute('repo', 'Parkseojin2001/Parkseojin2001.github.io');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', initTheme);
    script.crossOrigin = 'anonymous';
    script.async = true;

    const $footer = document.querySelector('footer');
    $footer.insertAdjacentElement('beforebegin', script);

    addEventListener('message', (event) => {
      let newTheme;if (event.source === window && event.data && event.data.id === Theme.ID) {
        newTheme = themeMapper[Theme.visualState];

        const message = {
          type: 'set-theme',
          theme: newTheme
        };

        const utterances = document.querySelector('.utterances-frame').contentWindow;
        utterances.postMessage(message, origin);
      }
    });
  })();
</script>



    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

