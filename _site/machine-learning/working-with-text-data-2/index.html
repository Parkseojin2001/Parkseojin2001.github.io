<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="텍스트 데이터 다루기(2)" />
<meta property="og:locale" content="en" />
<meta name="description" content="파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트" />
<meta property="og:description" content="파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트" />
<link rel="canonical" href="http://localhost:4000/machine-learning/working-with-text-data-2/" />
<meta property="og:url" content="http://localhost:4000/machine-learning/working-with-text-data-2/" />
<meta property="og:site_name" content="Seojin Devlog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-18T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="텍스트 데이터 다루기(2)" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="google-site-verification" content="WfkV1-iar8_v-Mbi-ytl5RBJhiNOfpUEWrLuOCyThLQ" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-24T00:00:00+09:00","datePublished":"2023-02-18T00:00:00+09:00","description":"파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트","headline":"텍스트 데이터 다루기(2)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/machine-learning/working-with-text-data-2/"},"url":"http://localhost:4000/machine-learning/working-with-text-data-2/"}</script>
<!-- End Jekyll SEO tag -->


  <title>텍스트 데이터 다루기(2) | Seojin Devlog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Seojin Devlog">
<meta name="application-name" content="Seojin Devlog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Seojin Devlog</a>
    <p class="site-subtitle fst-italic mb-0">AI 기술을 배우고 코드로 기록하는 학생 개발자입니다</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/Parkseojin2001"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['seojin0510612','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/seojin-park-793a15287/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>텍스트 데이터 다루기(2)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>텍스트 데이터 다루기(2)</h1>
    
      <p class="post-desc fw-light mb-4">파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1676646000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb 18, 2023
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1677196800"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb 24, 2023
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">Seojin Park</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4682 words"
>
  <em>26 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">텍스트 데이터 다루기(2)</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">텍스트 데이터 다루기(2)</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="76-모델-계수-조사"><span class="me-2">7.6 모델 계수 조사</span><a href="#76-모델-계수-조사" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<p>로지스틱 회귀 모델이 실제로 이 데이터에서 무엇을 학습했는지 자세히 볼 수 있음</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1"># 가장 큰 계수 40개와 가장 작은 계수 40개를 출력
# tf-idf 특성으로 훈련시킨 로지스틱 회귀의 최댓값, 최솟값 계수
# 막대의 크기 : 계수의 크기
</span><span class="n">mglearn</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="nf">visualize_coefficients</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">.</span><span class="n">named_steps</span><span class="p">[</span><span class="sh">"</span><span class="s">logisticregression</span><span class="sh">"</span><span class="p">].</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">feature_names</span><span class="p">,</span> <span class="n">n_top_features</span> <span class="o">=</span> <span class="mi">40</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_51_0.png" class="popup img-link shimmer"><img src="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_51_0.png" loading="lazy"></a></p>

<ul>
  <li>왼쪽의 음수 계수 : 부정적인 리뷰를 의미하는 단어가 속함</li>
  <li>오른쪽의 음수 계수 : 긍정적인 리뷰를 의미하는 단어가 속함</li>
  <li>“bit”, “job”, “today” 같은 단어는 덜 명확하지만 아마도 “good job”이나 “best today” 같은 구절의 일부로 볼 수 있음</li>
</ul>

<h2 id="77-여러-단어로-만든-bow-n---그램"><span class="me-2">7.7 여러 단어로 만든 BOW (n - 그램)</span><a href="#77-여러-단어로-만든-bow-n---그램" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<p>BOW 표현 방식은 단어의 순서가 완전히 무시된다는 단점이 있다.
ex. “it’s bad, not good at all” = “it’s good, not bad at all”</p>

<p><strong>해결 방안</strong></p>

<ul>
  <li>토큰 하나의 횟수만 고려하지 않고 옆에 있는 두 세 개의 토큰을 함께 고려하는 방식으로 단점을 보안한다.</li>
  <li><code class="language-plaintext highlighter-rouge">n - 그램(n-gram)</code> : 연속된 n개의 토크를 함께 고려하는 방식
    <ul>
      <li>바이그램(bigram) : 토큰 두 개</li>
      <li>트라이그램(trigram) : 토큰 세 개</li>
    </ul>
  </li>
  <li>CountVectorizer &amp; TfidfVectorizer : ngram_range 매개변수에 특성으로 고려할 토큰의 범위를 지정할 수 있음</li>
  <li>n_gram_range : 입력값은 튜플이며 고려할 토큰의 범위를 지정할 수 있음</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">bards_words:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">bards_words</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
bards_words:
 [</span><span class="sh">'</span><span class="s">The fool doth think he is wise,</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">but the wise man knows himself to be a fool</span><span class="sh">'</span><span class="s">]
</span><span class="sh">"""</span>

<span class="c1"># 기본값은 최소 길이 1이며 최대 길이가 1인 토큰(1 ~ 1)마다 하나의 특성을 형성 = 유니그램(토큰 하나)
</span><span class="n">cv</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)).</span><span class="nf">fit</span><span class="p">(</span><span class="n">bards_words</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어휘 사전 크기:</span><span class="sh">"</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">cv</span><span class="p">.</span><span class="n">vocabulary_</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어휘 사전:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">cv</span><span class="p">.</span><span class="nf">get_feature_names_out</span><span class="p">())</span>

<span class="sh">"""</span><span class="s">

어휘 사전 크기: 13
어휘 사전:
 [</span><span class="sh">'</span><span class="s">be</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">but</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">doth</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">fool</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">he</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">himself</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">is</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">knows</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">man</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">think</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">to</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">wise</span><span class="sh">'</span><span class="s">]
</span><span class="sh">"""</span>

<span class="c1"># 토큰 두 개가 연속된 바이그램
</span><span class="n">cv</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)).</span><span class="nf">fit</span><span class="p">(</span><span class="n">bards_words</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어휘 사전 크기:</span><span class="sh">"</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">cv</span><span class="p">.</span><span class="n">vocabulary_</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어휘 사전:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">cv</span><span class="p">.</span><span class="nf">get_feature_names_out</span><span class="p">())</span>

<span class="sh">"""</span><span class="s">
어휘 사전 크기: 14
어휘 사전:
 [</span><span class="sh">'</span><span class="s">be fool</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">but the</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">doth think</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">fool doth</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">he is</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">himself to</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">is wise</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">knows himself</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">man knows</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the fool</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the wise</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">think he</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">to be</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">wise man</span><span class="sh">'</span><span class="s">]
</span><span class="sh">"""</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">변환된 데이터 (밀집 배열):</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span><span class="n">cv</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">bards_words</span><span class="p">).</span><span class="nf">toarray</span><span class="p">())</span>

<span class="sh">"""</span><span class="s">
변환된 데이터 (밀집 배열):
 [[0 0 1 1 1 0 1 0 0 1 0 1 0 0]
 [1 1 0 0 0 1 0 1 1 0 1 0 1 1]]
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>연속된 토큰의 수가 커지면 보통 특성이 더 구체적이고 많이 만들어짐</li>
  <li>토큰의 수가 커지면 특성의 개수와 구체적인 특성이 매우 많아지므로 과대적합될 가능성이 있음</li>
  <li>이론상 바이그램(n = 2)수는 유니그램(n = 1)수의 제곱이 되고, 트라이그램(n = 3)수는 유니그램의 세제곱이 됨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre><span class="c1"># bards_words에 유니그램, 바이그램, 트라이그램을 적용
</span><span class="n">cv</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)).</span><span class="nf">fit</span><span class="p">(</span><span class="n">bards_words</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어휘 사전 크기:</span><span class="sh">"</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">cv</span><span class="p">.</span><span class="n">vocabulary_</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어휘 사전:</span><span class="sh">"</span><span class="p">,</span> <span class="n">cv</span><span class="p">.</span><span class="nf">get_feature_names_out</span><span class="p">())</span>

<span class="sh">"""</span><span class="s">
어휘 사전 크기: 39
어휘 사전: [</span><span class="sh">'</span><span class="s">be</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">be fool</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">but</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">but the</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">but the wise</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">doth</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">doth think</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">doth think he</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">fool</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">fool doth</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">fool doth think</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">he</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">he is</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">he is wise</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">himself</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">himself to</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">himself to be</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">is</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">is wise</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">knows</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">knows himself</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">knows himself to</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">man</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">man knows</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">man knows himself</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the fool</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the fool doth</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">the wise</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">the wise man</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">think</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">think he</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">think he is</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">to</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">to be</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">to be fool</span><span class="sh">'</span><span class="s">
 </span><span class="sh">'</span><span class="s">wise</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">wise man</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="s">wise man knows</span><span class="sh">'</span><span class="s">]
</span><span class="sh">"""</span>

<span class="c1"># min_df : 토큰이 나타날 최소 문서 개수를 지정
</span><span class="n">pipe</span> <span class="o">=</span> <span class="nf">make_pipeline</span><span class="p">(</span><span class="nc">TfidfVectorizer</span><span class="p">(</span><span class="n">min_df</span> <span class="o">=</span> <span class="mi">5</span><span class="p">),</span> <span class="nc">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">))</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">logisticregression__C</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
              <span class="sh">'</span><span class="s">tfidfvectorizer__ngram_range</span><span class="sh">'</span> <span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]}</span>

<span class="n">grid</span> <span class="o">=</span> <span class="nc">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">text_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">최상의 교차 검증 점수 : {:.2f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">grid</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">최적의 매개변수:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">grid</span><span class="p">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
최상의 교차 검증 점수 : 0.91
최적의 매개변수:
 {</span><span class="sh">'</span><span class="s">logisticregression__C</span><span class="sh">'</span><span class="s">: 100, </span><span class="sh">'</span><span class="s">tfidfvectorizer__ngram_range</span><span class="sh">'</span><span class="s">: (1, 3)}
</span><span class="sh">"""</span>

<span class="c1"># 매개변수 ngram_range와 C에 대한 평균 교차 검증 정확도의 히트맵
#그리드 서치에서 테스트 점수 추출
</span><span class="n">scores</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="sh">'</span><span class="s">mean_test_score</span><span class="sh">'</span><span class="p">].</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="n">T</span>
<span class="c1"># 히트랩 그리기
</span><span class="n">heatmap</span> <span class="o">=</span> <span class="n">mglearn</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="nf">heatmap</span><span class="p">(</span>
    <span class="n">scores</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="sh">'</span><span class="s">ngram_range</span><span class="sh">'</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="sh">'</span><span class="s">viridis</span><span class="sh">'</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="sh">'</span><span class="s">%.3f</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">param_grid</span><span class="p">[</span><span class="sh">'</span><span class="s">logisticregression__C</span><span class="sh">'</span><span class="p">],</span>
    <span class="n">yticklabels</span> <span class="o">=</span> <span class="n">param_grid</span><span class="p">[</span><span class="sh">'</span><span class="s">tfidfvectorizer__ngram_range</span><span class="sh">'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_61_0.png" class="popup img-link shimmer"><img src="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_61_0.png" loading="lazy"></a></p>

<ul>
  <li>바이그램(n = 2)이 성능을 크게 높여주며 트리아그램은 정확도 축면에서 성능이 조금나 향상됨.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># tf-idf와 유니그램, 바이그램, 트라이그램을 사용한 모델에서 가장 중요한 특성
# 특성 이름과 계수를 추출
</span><span class="n">vect</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">.</span><span class="n">named_steps</span><span class="p">[</span><span class="sh">'</span><span class="s">tfidfvectorizer</span><span class="sh">'</span><span class="p">]</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">vect</span><span class="p">.</span><span class="nf">get_feature_names_out</span><span class="p">())</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">.</span><span class="n">named_steps</span><span class="p">[</span><span class="sh">'</span><span class="s">logisticregression</span><span class="sh">'</span><span class="p">].</span><span class="n">coef_</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="nf">visualize_coefficients</span><span class="p">(</span><span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">n_top_features</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_63_0.png" class="popup img-link shimmer"><img src="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_63_0.png" loading="lazy"></a></p>

<ul>
  <li>“not worth”는 부정적인 리뷰를 의미하지만 “definitely worth” 와 “well worth”는 긍정적인 리뷰를 암시하는 새로운 특성이 나타남
    <ul>
      <li>“worth” 단어의 의미에 영향을 주는 예시임</li>
    </ul>
  </li>
  <li>바이그램 (and 트라이그램) 에서 독립적일 땐 큰 의미가 없는 단어들이 뭉쳐 의미가 있는 단어들로 구성되어있었음</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># 모델의 트라이그램 중요도를 나타낸 그래프
# 트라이그램 특성을 찾음
</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="nf">len</span><span class="p">(</span><span class="n">feature</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">))</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span>
<span class="c1"># 트라이그램 특성만 그래프로 나타남
</span><span class="n">mglearn</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="nf">visualize_coefficients</span><span class="p">(</span><span class="n">coef</span><span class="p">.</span><span class="nf">ravel</span><span class="p">()[</span><span class="n">mask</span><span class="p">],</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">n_top_features</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_65_0.png" class="popup img-link shimmer"><img src="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_65_0.png" loading="lazy"></a></p>

<h2 id="78-고급-토큰화-어간-추출-표제어-추출"><span class="me-2">7.8 고급 토큰화, 어간 추출, 표제어 추출</span><a href="#78-고급-토큰화-어간-추출-표제어-추출" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<ul>
  <li>어휘 사전에 단수와 복수 단어가 함께 포함되어 있는 경우
    <ul>
      <li>ex. drawback and drawbacks / draw and drawers / drawing and drawings</li>
    </ul>
  </li>
  <li>여러 동사형과 관련 단어들
    <ul>
      <li>ex. replace, replaced, replacement, replaces, replacing</li>
    </ul>
  </li>
</ul>

<p>의미는 매우 가까운 단어들을 구분하게 되면 과대적합되기 쉽고 훈련 데이터를 완전하게 활용하지 못함</p>

<p><strong>해결 방법</strong></p>

<p>각 단어를 그 단어의 어간으로 표현해서 같은 어간을 가진 모든 단어를 구분해야 (또는 합쳐야) 한다.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">어간 추출(stemming)</code>:  어미를 찾아 제외하는 규칙 기반 방식</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">표제어 추출(lemmatization)</code>: 단어의 형태 사전을 사용하고 문장에서 단어의 역할을 고려하는 처리 방식</p>
    <ul>
      <li>어간 추출 + 표제어 추출 (+ 맞춤법 교정) = <code class="language-plaintext highlighter-rouge">정규화</code>하는 과정</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="n">pip</span> <span class="n">install</span> <span class="n">nltk</span> <span class="n">spacy</span>

<span class="kn">import</span> <span class="n">spacy</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">en_nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="sh">'</span><span class="s">en_core_web_sm</span><span class="sh">'</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">spacy</span>
    <span class="err">!</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">en</span>

<span class="kn">import</span> <span class="n">spacy</span>
<span class="kn">import</span> <span class="n">nltk</span>

<span class="c1"># spacy의 영어 모델을 로드
</span><span class="n">en_nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="sh">'</span><span class="s">en_core_web_sm</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># nltk의 PorterStemmer 객체를 생성
</span><span class="n">stemmer</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">stem</span><span class="p">.</span><span class="nc">PorterStemmer</span><span class="p">()</span>

<span class="c1"># spacy의 표제어 추출과 nltk의 어간 추출을 비교하는 함수
</span><span class="k">def</span> <span class="nf">compare_normalization</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
  <span class="c1"># spacy로 문서를 토큰화
</span>  <span class="n">doc_spacy</span> <span class="o">=</span> <span class="nf">en_nlp</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
  <span class="c1"># spacy로 찾은 표제어를 출력
</span>  <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">표제어:</span><span class="sh">"</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">([</span><span class="n">token</span><span class="p">.</span><span class="n">lemma_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc_spacy</span><span class="p">])</span>
  <span class="c1"># PorterStemmer로 찾은 토큰을 출력
</span>  <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">어간:</span><span class="sh">"</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">([</span><span class="n">stemmer</span><span class="p">.</span><span class="nf">stem</span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="n">norm_</span><span class="p">.</span><span class="nf">lower</span><span class="p">())</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc_spacy</span><span class="p">])</span>

<span class="nf">compare_normalization</span><span class="p">(</span><span class="sa">u</span><span class="sh">"</span><span class="s">Our meeting today was worse than yesterday, </span><span class="sh">"</span>
                      <span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m scared of meeting the clients tomorrow.</span><span class="sh">"</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
표제어:
[</span><span class="sh">'</span><span class="s">our</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">meeting</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">today</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">be</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">bad</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">than</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">yesterday</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">I</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">be</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">scared</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">of</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">meet</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">the</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">client</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">tomorrow</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="s">]
어간:
[</span><span class="sh">'</span><span class="s">our</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">meet</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">today</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">wa</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">wors</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">than</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">yesterday</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">am</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">scare</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">of</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">meet</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">the</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">client</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">tomorrow</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="s">]
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>어간 추출은 항상 단어의 어간만 남기므로 “was”는 “wa”가 되지만, 표제어 추출은 올바른 동사형인 “be”를 추출</li>
  <li>표제어 추출은 “worse”를 “bad”로 정규화시키는 반면 어간 추출은 “wors”가 됨</li>
  <li>어간 추출은 두 번의 “meeting”을 “meet”로 바꿨지만 표제어 추출은 첫 번쨰 “meeting”은 명사로 인식해 그대로 두고 두 번째 나타냈을 땐 동사로 인식해 “meet”로 변환</li>
</ul>

<p>표제어 추출은 어간 추출보다 훨씬 복잡한 처리를 거침 → 어간 추출보다 더 좋은 결과를 낸다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="c1"># 요구 사항: spacy에서 표제어 추출 기능과 CountVectorizer의 토큰 분할기를 사용
</span>
<span class="c1"># spacy의 언어 모델을 로드
</span><span class="n">en_nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="sh">'</span><span class="s">en_core_web_sm</span><span class="sh">'</span><span class="p">,</span> <span class="n">disable</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">parser</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ner</span><span class="sh">'</span><span class="p">])</span>

<span class="c1"># spacy 문서 처리 파이프라인을 사용해 자작 토큰 분할기 생성
</span><span class="k">def</span> <span class="nf">custom_tokenizer</span><span class="p">(</span><span class="n">document</span><span class="p">):</span>
  <span class="n">doc_spacy</span> <span class="o">=</span> <span class="nf">en_nlp</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">token</span><span class="p">.</span><span class="n">lemma_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc_spacy</span><span class="p">]</span>

<span class="c1"># 자작 토큰 분할기를 사용해 CountVectorizer 객체를 생성
</span><span class="n">lemma_vect</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">custom_tokenizer</span><span class="p">,</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># 표제어 추출이 가능 한 CountVectorizer 객체로 text_train을 변환
</span><span class="n">X_train_lemma</span> <span class="o">=</span> <span class="n">lemma_vect</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">text_train</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">X_train_lemma.shape:</span><span class="sh">"</span><span class="p">,</span> <span class="n">X_train_lemma</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># 비교를 위해 표준 CountVectorizer를 사용
</span><span class="n">vect</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span> <span class="o">=</span> <span class="mi">5</span><span class="p">).</span><span class="nf">fit</span><span class="p">(</span><span class="n">text_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">vect</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">text_train</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">X_train.shape</span><span class="sh">"</span><span class="p">,</span> <span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
X_train_lemma.shape: (25000, 21925)
X_train.shape (25000, 27271)
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>27,271개에서 20660개로 줄음 → 표제어 추출은 일부 특성들을 합치기 때문임</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="c1"># 훈련 세트의 1%만 사용해서 그리드 서치를 생성
</span><span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedShuffleSplit</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="n">cv</span> <span class="o">=</span> <span class="nc">StratifiedShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.99</span><span class="p">,</span>
                            <span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="nc">GridSearchCV</span><span class="p">(</span><span class="nc">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 기본 CountVectorizer로 그리드 서치를 수행
</span><span class="n">grid</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">최상의 교차 검증 점수 </span><span class="sh">"</span>
      <span class="sh">"</span><span class="s">(기본 CountVectorizer): {:.3f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">grid</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>

<span class="c1"># 표제어를 사용해서 그리드 서치를 수행
</span><span class="n">grid</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train_lemma</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">최상의 교차 검증 점수</span><span class="sh">"</span>
      <span class="sh">"</span><span class="s">(표제어): {:.3f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">grid</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>

<span class="sh">"""</span><span class="s">
최상의 교차 검증 점수 (기본 CountVectorizer): 0.719
최상의 교차 검증 점수(표제어): 0.717
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="79-토픽-모델링과-문서-군집화"><span class="me-2">7.9 토픽 모델링과 문서 군집화</span><a href="#79-토픽-모델링과-문서-군집화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<p><code class="language-plaintext highlighter-rouge">토픽 모델링(topic modeling)</code>: 텍스트 데이터에 자주 적용하는 기법으로 비지도 학습으로 문서를 하나 또는 그 이상의 토픽으로 할당하는 작업을 통칭함</p>

<ul>
  <li>한 문서가 하나의 토픽에 할당하면 같은 문서를 군집시킴</li>
  <li>문서가 둘 이상의 토픽을 가질 수 있다면 분해 방법임</li>
  <li>학습된 각 성분은 하나의 토픽에 해당하며 문서를 표현한 성분의 계수는 문서가 어떤 토픽에 얼마만큼 연관되어 있음</li>
  <li><code class="language-plaintext highlighter-rouge">잠재 디리클레 할당(Latent Dirichlet Allocation, LDA)</code>: 토픽 모델링의 한 부분이며 특정한 성분 분해 방법을 말함.</li>
</ul>

<h3 id="791-lda"><span class="me-2">7.9.1 LDA</span><a href="#791-lda" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>LDA 모델은 함께 자주 나타나는 단어의 그룹(토픽)을 찾는 것이다.</li>
  <li>결과 왜곡 방지 : 자주 나타나는 단어 제거</li>
  <li>LDA는 각 문서에 토픽 (일반적인 ‘주제’가 아님) 의 일부가 혼합되어 있다고 간주함</li>
</ul>

<p>토픽의 예시로 아래와 같은 것이 있다.</p>

<ul>
  <li>정치 기사(‘주지사’, ‘선거’, ‘정당’ 등의 단어가 자주 사용)</li>
  <li>스포츠 기사(‘팀’, ‘점수’, ‘시즌’ 등의 단어가 자주 사용)</li>
  <li>A 기자가 즐겨 쓰는 단어 \ B 기자가 즐겨 쓰는 단어</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre><span class="c1"># LDA를 영화 리뷰 데이터셋에 적용
</span><span class="n">vect</span> <span class="o">=</span> <span class="nc">CountVectorizer</span><span class="p">(</span><span class="n">max_features</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">max_df</span> <span class="o">=</span> <span class="p">.</span><span class="mi">15</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">vect</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">text_train</span><span class="p">)</span>

<span class="kn">from</span> <span class="n">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">LatentDirichletAllocation</span>
<span class="n">lda</span> <span class="o">=</span> <span class="nc">LatentDirichletAllocation</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">learning_method</span> <span class="o">=</span> <span class="sh">"</span><span class="s">batch</span><span class="sh">"</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 모델 생성과 변환을 동시에 실행
</span><span class="n">document_topics</span> <span class="o">=</span> <span class="n">lda</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># components_ 속성에 각 단어의 중요도를 저장
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">lda.components_.shape:</span><span class="sh">"</span><span class="p">,</span> <span class="n">lda</span><span class="p">.</span><span class="n">components_</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># lda.components_.shape: (10, 10000)
</span>
<span class="c1"># 토픽의 의미 파악을 위해 가장 중요한 단어 출력
# 토픽마다(components_의 행) 특성을 오름차순으로 정렬
# 내림차순이 되도록 [:, ::-1] 사용해 행의 정렬을 반대로 바꿈
</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">lda</span><span class="p">.</span><span class="n">components_</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># CountVectorizer 객체에서 특성 이름을 구함
</span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">vect</span><span class="p">.</span><span class="nf">get_feature_names_out</span><span class="p">())</span>

<span class="c1"># 10개의 토픽 출력
</span><span class="n">mglearn</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="nf">print_topics</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span><span class="n">sorting</span><span class="o">=</span><span class="n">sorting</span><span class="p">,</span> <span class="n">topics_per_chunk</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_words</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
topic 0       topic 1       topic 2       topic 3       topic 4       
--------      --------      --------      --------      --------      
between       war           funny         show          didn          
family        world         comedy        series        saw           
young         us            guy           episode       thought       
real          american      re            tv            am            
us            our           laugh         episodes      got           
director      documentary   stupid        shows         10            
work          history       thing         season        thing         
beautiful     years         fun           new           want          
both          new           jokes         years         watched       
each          own           actually      musical       now           


topic 5       topic 6       topic 7       topic 8       topic 9       
--------      --------      --------      --------      --------      
action        kids          role          performance   house         
effects       action        cast          role          horror        
horror        children      john          john          killer        
nothing       animation     version       cast          gets          
budget        game          novel         actor         woman         
original      disney        both          oscar         wife          
director      fun           played        jack          girl          
script        old           young         plays         goes          
minutes       10            director      joe           dead          
doesn         kid           performance   performances  around        
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>토픽_1 : 역사와 전쟁 영화</li>
  <li>토픽_2 : 코미디물</li>
  <li>토픽_3 : TV 시리즈</li>
  <li>토픽_4 : 매우 일반적인 단어를 고름</li>
  <li>토픽_6 : 어린이 영화</li>
  <li>토픽_8 : 영화제와 관련됨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
</pre></td><td class="rouge-code"><pre><span class="c1"># 100개의 토픽으로 분석
</span><span class="n">lda100</span> <span class="o">=</span> <span class="nc">LatentDirichletAllocation</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">learning_method</span> <span class="o">=</span> <span class="sh">"</span><span class="s">batch</span><span class="sh">"</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">document_topics100</span> <span class="o">=</span> <span class="n">lda100</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># 대표 토픽만 출력
</span><span class="n">topics</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>

<span class="n">sorting</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">lda100</span><span class="p">.</span><span class="n">components_</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">vect</span><span class="p">.</span><span class="nf">get_feature_names_out</span><span class="p">())</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">tools</span><span class="p">.</span><span class="nf">print_topics</span><span class="p">(</span><span class="n">topics</span> <span class="o">=</span> <span class="n">topics</span><span class="p">,</span> <span class="n">feature_names</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">,</span> <span class="n">topics_per_chunk</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n_words</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
topic 7       topic 16      topic 24      topic 25      topic 28      
--------      --------      --------      --------      --------      
horror        minutes       joe           car           beautiful     
creepy        didn          years         gets          real          
atmosphere    worst         young         guy           beautifully   
house         thing         new           around        canadian      
de            wasn          past          down          romantic      
thriller      boring        city          kill          scenery       
suspense      terrible      true          goes          between       
dark          nothing       cowboy        killed        simple        
mystery       got           midnight      take          wonderful     
scary         going         memories      going         true          
director      thought       place         away          highly        
mysterious    pretty        modesty       find          amazing       
blood         10            childhood     police        truly         
fans          stupid        come          head          moving        
strange       whole         kirk          house         young         
vampire       horrible      between       another       romance       
haunted       guy           age           right         cinematography
quite         re            york          guys          each          
hitchcock     actually      jon           getting       realistic     
genre         ending        us            takes         feel          


topic 36      topic 37      topic 41      topic 45      topic 51      
--------      --------      --------      --------      --------      
performance   japanese      jane          music         superman      
role          german        tarzan        rock          evil          
actor         american      code          song          world         
cast          hitler        jungle        songs         flying        
actors        japan         stanwyck      band          tim           
performances  history       pre           soundtrack    super         
play          germany       baby          roll          humans        
excellent     russian       barbara       fan           hero          
oscar         nazi          tribe         prince        men           
roles         von           swim          metal         clark         
supporting    historical    mate          voice         dragon        
played        european      ape           singer        robots        
actress       actors        mexico        concert       comics        
wonderful     nazis         harris        years         plane         
screen        accurate      savage        especially    apes          
brilliant     quite         randy         hear          real          
director      during        underwater    singing       new           
every         wwii          men           playing       burton        
superb        culture       cannibal      played        earth         
plays         facts         brent         sing          planet

topic 53      topic 54      topic 63      topic 89      topic 97      
--------      --------      --------      --------      --------      
musical       budget        monster       gore          didn          
stage         actors        pretty        zombie        ending        
broadway      low           fun           dead          felt          
numbers       director      re            horror        found         
star          script        creature      zombies       part          
number        camera        effects       blood         going         
production    poor          80            flesh         thought       
song          money         flick         gory          left          
songs         effects       cheesy        eating        again         
singing       production    stuff         living        interesting   
show          nothing       actually      flick         bit           
studio        shot          friday        fulci         maybe         
streisand     work          looking       fun           care          
voice         look          looks         romero        enough        
big           waste         hardy         effects       however       
hollywood     worst         kind          budget        wasn          
play          awful         flicks        body          seemed        
cagney        making        stan          re            between       
hit           terrible      special       actually      quite         
screen        special       guy           fans          point  
</span><span class="sh">"""</span>

<span class="c1"># 토픽을 이용한 추론을 위해 토픽에 할당된 문서를 보고 가장 높은 순위에 있는 단어의 의미를 확인
# 음악적인 토픽 45를 가중치로 정렬
</span><span class="n">music</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">document_topics100</span><span class="p">[:,</span> <span class="mi">45</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 이 토픽이 가장 비중이 큰 문서 다섯개를 출력
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">music</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
  <span class="c1"># 첫 두 문장을 출력
</span>  <span class="nf">print</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">.</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">text_train</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">.</span><span class="sh">"</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="s">.</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
b</span><span class="sh">'</span><span class="s">I love this movie and never get tired of watching. The music in it is great.</span><span class="se">\n</span><span class="sh">'</span><span class="s">
b</span><span class="sh">'</span><span class="s">I love this movie!!! Purple Rain came out the year I was born and it has had my heart since I can remember. Prince is so tight in this movie.</span><span class="se">\n</span><span class="sh">'</span><span class="s">
b</span><span class="sh">"</span><span class="s">What happens to washed up rock-n-roll stars in the late 1990</span><span class="sh">'</span><span class="s">s? They launch a comeback / reunion tour. At least, that</span><span class="sh">'</span><span class="s">s what the members of Strange Fruit, a (fictional) 70</span><span class="sh">'</span><span class="s">s stadium rock group do.</span><span class="se">\n</span><span class="sh">"</span><span class="s">
b</span><span class="sh">"</span><span class="s">I enjoyed Still Crazy more than any film I have seen in years. A successful band from the 70</span><span class="sh">'</span><span class="s">s decide to give it another try.</span><span class="se">\n</span><span class="sh">"</span><span class="s">
b</span><span class="sh">'</span><span class="s">As a big-time Prince fan of the last three to four years, I really can</span><span class="se">\'</span><span class="s">t believe I</span><span class="se">\'</span><span class="s">ve only just got round to watching </span><span class="sh">"</span><span class="s">Purple Rain</span><span class="sh">"</span><span class="s">. The brand new 2-disc anniversary Special Edition led me to buy it.</span><span class="se">\n</span><span class="sh">'</span><span class="s">
b</span><span class="sh">'</span><span class="s">I thought this movie was fantastic. It was hilarious.</span><span class="se">\n</span><span class="sh">'</span><span class="s">
b</span><span class="sh">"</span><span class="s">The funky, yet strictly second-tier British glam-rock band Strange Fruit breaks up at the end of the wild</span><span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="s">wacky excess-ridden 70</span><span class="sh">'</span><span class="s">s. The individual band members go their separate ways and uncomfortably settle into lackluster middle age in the dull and uneventful 90</span><span class="sh">'</span><span class="s">s: morose keyboardist Stephen Rea winds up penniless and down on his luck, vain, neurotic, pretentious lead singer Bill Nighy tries (and fails) to pursue a floundering solo career, paranoid drummer Timothy Spall resides in obscurity on a remote farm so he can avoid paying a hefty back taxes debt, and surly bass player Jimmy Nail installs roofs for a living.</span><span class="se">\n</span><span class="sh">"</span><span class="s">
b</span><span class="sh">"</span><span class="s">Surviving Christmas (2004) Ben Affleck, James Gandolfini, Christina Applegate, Catherine O</span><span class="sh">'</span><span class="s"> Hara, Josh Zuckerman, Bill Macy, Jennifer Morrison, Udo Kier, D: Mike Mitchell. Dumped by his girlfriend, a hotshot yuppie doesn</span><span class="sh">'</span><span class="s">t want to be left alone on Christmas so he decides to return to his boyhood home, imposing on the dysfunctional family that now lives there and bribes them to pose as his family.</span><span class="se">\n</span><span class="sh">"</span><span class="s">
b</span><span class="sh">"</span><span class="s">This movie is sort of a Carrie meets Heavy Metal. It</span><span class="sh">'</span><span class="s">s about a highschool guy who gets picked on alot and he totally gets revenge with the help of a Heavy Metal ghost.</span><span class="se">\n</span><span class="sh">"</span><span class="s">
b</span><span class="sh">'</span><span class="s">This film is the most cult movie on metal there is. Premise: A kid gets a hold of the final recording of his favorite artist Sammy Curr who recently dies in a hotel fire.</span><span class="se">\n</span><span class="sh">'</span><span class="s">
</span><span class="sh">"""</span>

<span class="c1"># 토픽을 조사하는 방법_2 : 각 토픽의 가중치가 얼마인지 모든 리뷰에 걸쳐 document_topics 값을 합함
# LDA로 학습한 토픽 가중치
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">topic_names</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">{:&gt;2} </span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">words</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">feature_names</span><span class="p">[</span><span class="n">sorting</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]])]</span>
<span class="c1"># 열이 두 개인 막대 그래프
</span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
  <span class="n">start</span> <span class="o">=</span> <span class="n">col</span> <span class="o">*</span> <span class="mi">50</span>
  <span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">barh</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">document_topics100</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">set_yticklabels</span><span class="p">(</span><span class="n">topic_names</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">],</span> <span class="n">ha</span> <span class="o">=</span> <span class="sh">"</span><span class="s">left</span><span class="sh">"</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="sh">"</span><span class="s">top</span><span class="sh">"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">invert_yaxis</span><span class="p">()</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
  <span class="n">yax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">get_yaxis</span><span class="p">()</span>
  <span class="n">yax</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">pad</span> <span class="o">=</span> <span class="mi">130</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_88_0.png" class="popup img-link shimmer"><img src="/../assets/img/post/ml_post/Chapter7_Working-with-text-data_files/Chapter7_Working-with-text-data_88_0.png" loading="lazy"></a></p>

<ul>
  <li>레이블이 없거나, 레이블이 있더라도 큰 규모의 텍스트 말뭉치를 해석하는 데 좋은 방법임</li>
  <li>LDA는 확률적 알고리즘이므로 random_state 매개변수를 바꾸면 결과가 달라짐</li>
  <li>토픽을 구별하는데 도움이 되지만 비지도 학습이므로 결론을 보수적으로 평가해야함(직접 보고 검증하는 것이 좋음)</li>
  <li>LDA.transform 메서드는 특성의 수를 줄일 수 있으므로 토픽이 지도 학습을 위한 압축된 표현으로 사용될 수 있음(훈련 샘플이 적을 때 유용)</li>
</ul>

<h2 id="710-요약과-정리"><span class="me-2">7.10 요약과 정리</span><a href="#710-요약과-정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<hr />

<ul>
  <li>텍스트 데이터를 처리하는 방법 : <strong>BOW 표현</strong>(텍스트 분류 작업)</li>
  <li>데이터의 표현이 자연어 처리의 핵심이고 추출된 토큰과 n - 그램을 분석하면 모델링 과정에서 필요한 통찰을 얻을 수 있음</li>
  <li>텍스트 처리 애플리케이션에서는 지도 학습이나 비지도 학습 작업을 위해 모델을 자체적으로 분석해 의미를 찾을 수 있는 경우가 많음</li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/machine-learning/">Machine Learning</a>,
          <a href="/categories/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D/">파이썬 라이브러리를 활용한 머신러닝</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ml/"
            class="post-tag no-text-decoration"
          >ml</a>
        
          <a
            href="/tags/python/"
            class="post-tag no-text-decoration"
          >python</a>
        
          <a
            href="/tags/scikit-learn/"
            class="post-tag no-text-decoration"
          >scikit-learn</a>
        
          <a
            href="/tags/nlp/"
            class="post-tag no-text-decoration"
          >NLP</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=%ED%85%8D%EC%8A%A4%ED%8A%B8%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%8B%A4%EB%A3%A8%EA%B8%B0(2)%20-%20Seojin%20Devlog&url=http%3A%2F%2Flocalhost%3A4000%2Fmachine-learning%2Fworking-with-text-data-2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=%ED%85%8D%EC%8A%A4%ED%8A%B8%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%8B%A4%EB%A3%A8%EA%B8%B0(2)%20-%20Seojin%20Devlog&u=http%3A%2F%2Flocalhost%3A4000%2Fmachine-learning%2Fworking-with-text-data-2%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fmachine-learning%2Fworking-with-text-data-2%2F&text=%ED%85%8D%EC%8A%A4%ED%8A%B8%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%8B%A4%EB%A3%A8%EA%B8%B0(2)%20-%20Seojin%20Devlog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/naver-boostcamp/computer-vision/01">CNN to ViT</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/naver-boostcamp/ml-life-cycle/09">Transformer2: Attention</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/naver-boostcamp/ml-life-cycle/04">기초 신경망 이론 1: Neural Network</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/naver-boostcamp/ml-life-cycle/05">기초 신경망 이론 2: Backpropagation</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/naver-boostcamp/ml-life-cycle/06">기초 신경망 이론 3: Trainig Neural Networks</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/naver-boostcamp/">Naver-Boostcamp</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pre-course/">Pre-Course</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pytorch/">pytorch</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ml/">ml</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/scikit-learn/">scikit-learn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nlp/">NLP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linear-algebra/">linear-algebra</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cnn/">CNN</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/machine-learning/working-with-text-data-1/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1675263600"
  data-df="ll"
  
>
  Feb  2, 2023
</time>

              <h4 class="pt-0 my-2">텍스트 데이터 다루기(1)</h4>
              <div class="text-muted">
                <p>파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/machine-learning/chain-pipeline/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1674486000"
  data-df="ll"
  
>
  Jan 24, 2023
</time>

              <h4 class="pt-0 my-2">알고리즘 체인과 파이프라인</h4>
              <div class="text-muted">
                <p>파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/machine-learning/eval_improv-3/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1671980400"
  data-df="ll"
  
>
  Dec 26, 2022
</time>

              <h4 class="pt-0 my-2">모델 평가와 성능 향상(3)</h4>
              <div class="text-muted">
                <p>파이썬 라이브러리를 활용한 머신러닝 책 내용 정리 포스트</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/machine-learning/working-with-text-data-1/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>텍스트 데이터 다루기(1)</p>
    </a>
  

  
    <a
      href="/data-structure/linear-1/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>선형 자료구조(1)</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/username">Seojin Park</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/naver-boostcamp/">Naver-Boostcamp</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pre-course/">Pre-Course</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pytorch/">pytorch</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ml/">ml</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/scikit-learn/">scikit-learn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nlp/">NLP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linear-algebra/">linear-algebra</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cnn/">CNN</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->

  
  <!-- https://utteranc.es/ -->
<script>
  (function () {
    const origin = 'https://utteranc.es';
    const themeMapper = Theme.getThemeMapper('github-light', 'github-dark');
    const initTheme = themeMapper[Theme.visualState];

    let script = document.createElement('script');
    script.src = 'https://utteranc.es/client.js';
    script.setAttribute('repo', 'Parkseojin2001/Parkseojin2001.github.io');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', initTheme);
    script.crossOrigin = 'anonymous';
    script.async = true;

    const $footer = document.querySelector('footer');
    $footer.insertAdjacentElement('beforebegin', script);

    addEventListener('message', (event) => {
      let newTheme;if (event.source === window && event.data && event.data.id === Theme.ID) {
        newTheme = themeMapper[Theme.visualState];

        const message = {
          type: 'set-theme',
          theme: newTheme
        };

        const utterances = document.querySelector('.utterances-frame').contentWindow;
        utterances.postMessage(message, origin);
      }
    });
  })();
</script>



    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

